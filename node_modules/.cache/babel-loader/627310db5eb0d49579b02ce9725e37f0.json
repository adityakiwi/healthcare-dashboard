{"ast":null,"code":"import _classCallCheck from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import*as d3 from'd3';import'./GroupedBarChart.css';import*as d3l from'd3-svg-legend';var GroupedBarChart=/*#__PURE__*/function(_React$Component){_inherits(GroupedBarChart,_React$Component);var _super=_createSuper(GroupedBarChart);function GroupedBarChart(props){var _this;_classCallCheck(this,GroupedBarChart);_this=_super.call(this,props);_this.removeExistingBars=_this.removeExistingBars.bind(_assertThisInitialized(_this));_this.createBarChart=_this.createBarChart.bind(_assertThisInitialized(_this));_this.state={svg:null,div:null,width:null,height:null,margin:null};return _this;}_createClass(GroupedBarChart,[{key:\"componentDidMount\",value:function componentDidMount(){var owidth=this.props.size[0];var oheight=this.props.size[1];var margin={top:20,right:0,bottom:20,left:70},width=owidth-margin.left-margin.right,height=oheight-margin.top-margin.bottom;var svg=d3.select(\"body\").select(\"#gbc\").select(\"svg\").attr(\"width\",width+margin.left+margin.right).attr(\"height\",height+margin.top+margin.bottom).append(\"g\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");var div=d3.select(\"body\").select(\"#gbc\").append(\"div\").attr(\"class\",\"tooltip-donut\").style(\"opacity\",0);this.setState({svg:svg,div:div,width:width,height:height,margin:margin});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.removeExistingBars();this.createBarChart();}},{key:\"midpoint\",value:function midpoint(range){return range[0]+(range[1]-range[0])/2.0;}},{key:\"removeExistingBars\",value:function removeExistingBars(){var svg=this.state.svg;svg.selectAll(\"*\").remove();}},{key:\"createBarChart\",value:function createBarChart(){var svg=this.state.svg;var div=this.state.div;var width=this.state.width;var height=this.state.height;var margin=this.state.margin;var data=this.props.data;var scale=this.props.scale.logarithmic;var label=this.props.selector;console.log(\"data\",data);var dnames=data.map(function(d){return d.diagnosis;});var gname=data[0].values.map(function(d){return d.distribution;});console.log(\"dname\",dnames);console.log(\"gname\",gname);function getKeyByValue(object,value){return Object.keys(object).find(function(key){return object[key]===value;});}var xScale=d3.scaleBand().range([0,width])// output\n.padding(0.1);var yScale;if(scale){console.log(\"logarithmic\");console.log(scale);yScale=d3.scaleLog().base(Math.E).domain([Math.exp(0),Math.exp(9)]).range([height,0]);}else{console.log(\"logarithmic\");console.log(scale);yScale=d3.scaleLinear().range([height,0]);// output\nyScale.domain([0,d3.max(data,function(key){return d3.max(key.values,function(d){return d.value;});})]);}var color=d3.scaleOrdinal().domain(gname).range(d3.schemeCategory10);console.log(\"graphdata\",data);var xScale1=d3.scaleBand();xScale.domain(dnames);xScale1.domain(gname).rangeRound([0,xScale.bandwidth()]);svg.append(\"g\").attr(\"class\",\"x axis\").attr(\"transform\",\"translate(0,\"+height+\")\").call(d3.axisBottom(xScale));svg.append(\"g\").attr(\"class\",\"y axis\").call(d3.axisLeft(yScale));var legend=d3l.legendColor().scale(color).shape('circle').orient('vertical').labelOffset(5);svg.append(\"g\").attr(\"class\",\"legend\").attr(\"transform\",\"translate(\"+(width-100)+\", \"+20+\")\");svg.select(\".legend\").call(legend);var slice=svg.selectAll(\".slice\").data(data).enter().append(\"g\").attr(\"class\",\"g\").attr(\"transform\",function(d){return\"translate(\"+xScale(d.diagnosis)+\",0)\";});slice.selectAll(\"rect\").data(function(d){return d.values;}).enter().append(\"rect\").attr(\"width\",xScale1.bandwidth()).attr(\"x\",function(d){{console.log(\"x\",d.distribution);}return xScale1(d.distribution);}).attr(\"y\",function(d){{console.log(d.value);}return yScale(d.value);}).style(\"fill\",function(d){return color(d.distribution);}).attr(\"height\",function(d){return height-yScale(d.value);}).on(\"mouseover\",function(event,d){d3.select(this).transition().duration('50').attr('opacity',.50);console.log(d,event);/// add to html\ndiv.transition().duration(50).style(\"opacity\",1);div.html(label+\": \"+d.distribution+\"<br>\"+\"Amount: \"+d.value).style(\"left\",event.pageX-30+\"px\").style(\"top\",event.pageY-15+\"px\");}).on(\"mouseout\",function(d){d3.select(this).transition().duration('50').attr('opacity',1);div.transition().duration('50').style(\"opacity\",0);});var size=1;svg.selectAll(\"g\").data(data).enter().append(\"text\").attr(\"x\",10).attr(\"y\",function(d,i){return 10;})// 100 is where the first dot appears. 25 is the distance between dots\n.style(\"fill\",function(d){return color(d.distribution);}).text(function(d){return d.distribution;}).attr(\"text-anchor\",\"left\");var xmid=xScale.range()[0]+(xScale.range()[1]-xScale.range()[0])/2.0;var ymid=yScale.range()[0]+(yScale.range()[1]-yScale.range()[0])/2.0;var xtitle=svg.append('text').attr('class','axis-title').text('Diseases');xtitle.attr('text-anchor','middle');xtitle.attr('x',xmid);xtitle.attr('y',height+40);var ytitle=svg.append('text').attr('class','axis-title').text('Number of Patients');ytitle.attr('x',xmid);ytitle.attr('y',height+40);ytitle.attr('dy','1.75ex');ytitle.attr('text-anchor','middle');ytitle.attr('transform','rotate(-90)');var tooltip=d3.select('#container').append('div').attr('class','tooltip').style('opacity',0);function mouseover(){d3.select(this).attr(\"opacity\",.5);}function mouseout(){d3.select(this).attr(\"opacity\",1);}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"svg\",null);}}]);return GroupedBarChart;}(React.Component);export default GroupedBarChart;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/GroupedBarChart.js"],"names":["React","d3","d3l","GroupedBarChart","props","removeExistingBars","bind","createBarChart","state","svg","div","width","height","margin","owidth","size","oheight","top","right","bottom","left","select","attr","append","style","setState","range","selectAll","remove","data","scale","logarithmic","label","selector","console","log","dnames","map","d","diagnosis","gname","values","distribution","getKeyByValue","object","value","Object","keys","find","key","xScale","scaleBand","padding","yScale","scaleLog","base","Math","E","domain","exp","scaleLinear","max","color","scaleOrdinal","schemeCategory10","xScale1","rangeRound","bandwidth","call","axisBottom","axisLeft","legend","legendColor","shape","orient","labelOffset","slice","enter","on","event","transition","duration","html","pageX","pageY","i","text","xmid","ymid","xtitle","ytitle","tooltip","mouseover","mouseout","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport './GroupedBarChart.css'\nimport * as d3l from 'd3-svg-legend'\n\nclass GroupedBarChart extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeExistingBars = this.removeExistingBars.bind(this);\n        this.createBarChart = this.createBarChart.bind(this)\n        this.state = {\n            svg: null,\n            div: null,\n            width: null,\n            height: null,\n            margin: null\n        };\n\n    }\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 0, bottom: 20, left: 70 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#gbc\").select(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n        const div = d3.select(\"body\").select(\"#gbc\").append(\"div\")\n            .attr(\"class\", \"tooltip-donut\")\n            .style(\"opacity\", 0);\n\n        this.setState({ svg, div, width, height, margin });\n    }\n    componentDidUpdate() {\n        this.removeExistingBars();\n        this.createBarChart();\n    }\n\n    midpoint(range) {\n        return range[0] + (range[1] - range[0]) / 2.0;\n    }\n\n    removeExistingBars() {\n        const { svg } = this.state;\n\n        svg.selectAll(\"*\").remove();\n\n    }\n\n    createBarChart() {\n        const { svg } = this.state;\n        const { div } = this.state;\n        const { width } = this.state;\n        const { height } = this.state;\n        const { margin } = this.state;\n\n\n        const data = this.props.data\n        const scale = this.props.scale.logarithmic\n        const label = this.props.selector\n\n        console.log(\"data\", data);\n        var dnames = data.map(function (d) { return d.diagnosis; });\n        var gname = data[0].values.map(function (d) { return d.distribution; });\n\n        console.log(\"dname\", dnames)\n        console.log(\"gname\", gname)\n\n\n        function getKeyByValue(object, value) {\n            return Object.keys(object).find(key => object[key] === value);\n        }\n\n\n        var xScale = d3.scaleBand()\n            .range([0, width]) // output\n            .padding(0.1)\n\n        var yScale;\n        if (scale)\n        {\n            console.log(\"logarithmic\")\n            console.log(scale)\n            yScale = d3.scaleLog()\n                .base(Math.E)\n                .domain([Math.exp(0), Math.exp(9)])\n                .range([height, 0]);        }\n        else{\n            console.log(\"logarithmic\")\n            console.log(scale)\n            yScale = d3.scaleLinear()\n                .range([height, 0]); // output\n            yScale.domain([0, d3.max(data, function (key) { return d3.max(key.values, function (d) { return d.value; }); })]);\n\n        }\n\n\n        var color = d3.scaleOrdinal()\n        .domain(gname)\n        .range(d3.schemeCategory10)\n\n        console.log(\"graphdata\", data)\n\n        var xScale1 = d3.scaleBand()\n\n        xScale.domain(dnames);\n        xScale1.domain(gname).rangeRound([0, xScale.bandwidth()]);\n\n\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(d3.axisBottom(xScale));\n\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(d3.axisLeft(yScale));\n\n\n        var legend = d3l.legendColor()\n            .scale(color)\n            .shape('circle')\n            .orient('vertical')\n            .labelOffset(5)\n\n\n        svg.append(\"g\")\n            .attr(\"class\", \"legend\")\n            .attr(\"transform\", \"translate(\" + (width-100) + \", \" + 20+\")\");\n\n\n        svg.select(\".legend\")\n            .call(legend);\n\n        var slice = svg.selectAll(\".slice\")\n            .data(data)\n            .enter().append(\"g\")\n            .attr(\"class\", \"g\")\n            .attr(\"transform\", function (d) { return \"translate(\" + xScale(d.diagnosis) + \",0)\"; });\n\n\n        slice.selectAll(\"rect\")\n            .data(function (d) { return d.values; })\n            .enter().append(\"rect\")\n            .attr(\"width\", xScale1.bandwidth())\n            .attr(\"x\", function (d) { { console.log(\"x\", d.distribution) } return xScale1(d.distribution); })\n            .attr(\"y\", function (d) { { console.log(d.value) } return yScale(d.value); })\n            .style(\"fill\", function (d) { return color(d.distribution) })\n\n            .attr(\"height\", function (d) { return height - yScale(d.value); })\n            .on(\"mouseover\", function (event, d) {\n                d3.select(this).transition()\n                    .duration('50')\n                    .attr('opacity', .50);\n                console.log(d, event)\n                /// add to html\n                div.transition()\n                    .duration(50)\n                    .style(\"opacity\", 1)\n\n                div.html(label +\": \" + d.distribution + \"<br>\" + \"Amount: \" + d.value)\n                    .style(\"left\", (event.pageX - 30) + \"px\")\n                    .style(\"top\", (event.pageY - 15) + \"px\")\n\n            })\n            .on(\"mouseout\", function (d) {\n                d3.select(this).transition()\n                    .duration('50')\n                    .attr('opacity', 1)\n                div.transition()\n                    .duration('50')\n                    .style(\"opacity\", 0)\n            })\n\n        let size = 1\n        svg.selectAll(\"g\")\n            .data(data)\n            .enter()\n            .append(\"text\")\n            .attr(\"x\", 10)\n            .attr(\"y\", function (d, i) { return 10 }) // 100 is where the first dot appears. 25 is the distance between dots\n            .style(\"fill\", function (d) { return color(d.distribution) })\n            .text(function (d) { return d.distribution })\n            .attr(\"text-anchor\", \"left\")\n\n\n\n        const xmid = xScale.range()[0] + (xScale.range()[1] - xScale.range()[0]) / 2.0;\n        const ymid = yScale.range()[0] + (yScale.range()[1] - yScale.range()[0]) / 2.0;\n        const xtitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('Diseases');\n        xtitle.attr('text-anchor', 'middle');\n        xtitle.attr('x', xmid);\n        xtitle.attr('y', height + 40);\n        const ytitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('Number of Patients')\n        ytitle.attr('x', xmid);\n        ytitle.attr('y', height + 40);\n        ytitle.attr('dy', '1.75ex');\n        ytitle.attr('text-anchor', 'middle');\n        ytitle.attr('transform', 'rotate(-90)');\n\n        const tooltip = d3\n            .select('#container')\n            .append('div')\n            .attr('class', 'tooltip')\n            .style('opacity', 0);\n\n        function mouseover() {\n            d3.select(this).attr(\"opacity\", .5)\n        }\n\n        function mouseout() {\n            d3.select(this).attr(\"opacity\", 1);\n        }\n    }\n\n    render() {\n        return (\n            <svg/>\n        )\n    }\n}\n\nexport default GroupedBarChart;\n"]},"metadata":{},"sourceType":"module"}