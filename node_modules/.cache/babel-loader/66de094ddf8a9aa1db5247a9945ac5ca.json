{"ast":null,"code":"var _jsxFileName = \"/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/TreeMap.js\";\nimport React from 'react';\nimport * as d3 from 'd3';\nimport { range } from 'd3';\n\nclass TreeMap extends React.Component {\n  constructor(props) {\n    super(props);\n    this.removeMap = this.removeMap.bind(this);\n    this.createMap = this.createMap.bind(this);\n    this.state = {\n      svg: null,\n      div: null,\n      width: null,\n      height: null\n    };\n  }\n\n  componentDidMount() {\n    const owidth = this.props.size[0];\n    const oheight = this.props.size[1];\n    var margin = {\n      top: 20,\n      right: 20,\n      bottom: 70,\n      left: 100\n    },\n        width = owidth - margin.left - margin.right,\n        height = oheight - margin.top - margin.bottom;\n    const svg = d3.select(\"body\").select(\"#tm\").select(\"svg\").attr(\"width\", width).attr(\"height\", height);\n    this.setState({\n      svg\n    });\n    this.setState({\n      width\n    });\n    this.setState({\n      height\n    });\n  }\n\n  componentDidUpdate() {\n    this.removeMap();\n    this.createMap();\n  }\n\n  removeMap() {\n    const {\n      svg\n    } = this.state;\n    svg.selectAll(\"*\").remove();\n  }\n\n  createMap() {\n    const {\n      svg\n    } = this.state;\n    const {\n      width\n    } = this.state;\n    const {\n      height\n    } = this.state;\n    var tooltip = d3.select(\"body\").append(\"div\").style(\"position\", \"absolute\").style(\"z-index\", \"10\").style(\"visibility\", \"hidden\").style(\"color\", \"white\").style(\"padding\", \"8px\").style(\"background-color\", \"rgba(0, 0, 0, 0.75)\").style(\"border-radius\", \"6px\").style(\"font\", \"12px sans-serif\").text(\"tooltip\");\n    const rawdata = this.props.data;\n    let dataset = {\n      name: \"q8\",\n      \"children\": []\n    };\n    rawdata.forEach(function (d) {\n      dataset[\"children\"].push({\n        name: d.diagnosis,\n        children: d.values\n      });\n    });\n    let data = dataset;\n    console.log(data);\n    const hierarchy = d3.hierarchy(data).sum(d => d.value) //sum every child's values\n    .sort((a, b) => b.value - a.value); // and sort them in descending order \n\n    const treemap = d3.treemap().size([width, height]) // width: 400px, height:450px\n    .padding(1); // set padding to 1\n\n    const categories = dataset.children.map(d => d.name);\n    const root = treemap(hierarchy);\n    const colors = ['#1C1832', '#9E999D', '#F2259C', '#347EB4', '#08ACB6', '#91BB91', '#BCD32F', '#75EDB8', \"#89EE4B\", '#AD4FE8', '#D5AB61', '#BC3B3A', '#F6A1F9', '#87ABBB', '#412433', '#56B870', '#FDAB41', '#64624F'];\n    const colorScale = d3.scaleOrdinal() // the scale function\n    .domain(categories) // the data\n    .range(colors); // the way the data should be shown\n\n    svg.selectAll(\"rect\").data(root.leaves()).enter().append(\"rect\").attr(\"x\", d => d.x0).attr(\"y\", d => d.y0).attr(\"width\", d => d.x1 - d.x0).attr(\"height\", d => d.y1 - d.y0).attr(\"fill\", d => colorScale(d.data.value)).attr(\"font-size\", \"15px\");\n    svg.selectAll('text').data(root.leaves()).enter().append('text').selectAll('tspan').data(d => {\n      {\n        console.log(d.parent.data.name);\n      }\n      return d.parent.data.name.split(/(?=[A-Z][^A-Z])/g). // split the name of movie\n      map(v => {\n        {\n          console.log(v);\n        }\n        return {\n          text: v,\n          x0: d.x0,\n          // keep x0 reference\n          y0: d.y0 // keep y0 reference\n\n        };\n      });\n    }).enter().append('tspan').attr(\"x\", d => d.x0 + 5).attr(\"y\", (d, i) => d.y0 + 15 + i * 2) // offset by index \n    .text(d => d.text).attr(\"font-size\", \"0.5em\").attr(\"fill\", \"white\");\n    svg.selectAll('rect').on(\"mouseover\", function (d) {\n      {\n        console.log(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value);\n      }\n      tooltip.text(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value);\n      tooltip.style(\"visibility\", \"visible\");\n    }).on(\"mousemove\", function (event, d) {\n      return tooltip.style(\"top\", event.pageY - 10 + \"px\").style(\"left\", event.pageX + 10 + \"px\");\n    }).on(\"mouseout\", function () {\n      return tooltip.style(\"visibility\", \"hidden\");\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"svg\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 13\n      }\n    });\n  }\n\n}\n\nexport default TreeMap;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/TreeMap.js"],"names":["React","d3","range","TreeMap","Component","constructor","props","removeMap","bind","createMap","state","svg","div","width","height","componentDidMount","owidth","size","oheight","margin","top","right","bottom","left","select","attr","setState","componentDidUpdate","selectAll","remove","tooltip","append","style","text","rawdata","data","dataset","name","forEach","d","push","diagnosis","children","values","console","log","hierarchy","sum","value","sort","a","b","treemap","padding","categories","map","root","colors","colorScale","scaleOrdinal","domain","leaves","enter","x0","y0","x1","y1","parent","split","v","i","on","path","__data__","event","pageY","pageX","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport { range } from 'd3';\n\nclass TreeMap extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeMap = this.removeMap.bind(this);\n        this.createMap = this.createMap.bind(this)\n        this.state = {\n            svg: null,\n            div: null,\n            width: null,\n            height: null,\n        };\n\n    }\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#tm\").select(\"svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n\n        this.setState({ svg });\n\n        this.setState({ width });\n        this.setState({ height });\n\n    }\n    componentDidUpdate() {\n        this.removeMap();\n        this.createMap();\n    }\n\n\n    removeMap() {\n        const { svg } = this.state;\n\n        svg.selectAll(\"*\").remove();\n\n    }\n\n    createMap() {\n        const { svg } = this.state;\n        const { width } = this.state;\n        const { height } = this.state;\n        var tooltip = d3.select(\"body\")\n            .append(\"div\")\n            .style(\"position\", \"absolute\")\n            .style(\"z-index\", \"10\")\n            .style(\"visibility\", \"hidden\")\n            .style(\"color\", \"white\")\n            .style(\"padding\", \"8px\")\n            .style(\"background-color\", \"rgba(0, 0, 0, 0.75)\")\n            .style(\"border-radius\", \"6px\")\n            .style(\"font\", \"12px sans-serif\")\n            .text(\"tooltip\");\n\n        const rawdata = this.props.data\n        let dataset = {\n            name: \"q8\",\n            \"children\": []\n        };\n\n        rawdata.forEach(function (d) {\n            dataset[\"children\"].push({\n                name: d.diagnosis,\n                children: d.values\n            })\n        })\n        let data = dataset\n        console.log(data)\n        const hierarchy = d3.hierarchy(data)\n            .sum(d => d.value)  //sum every child's values\n            .sort((a, b) => b.value - a.value) // and sort them in descending order \n        const treemap = d3.treemap()\n            .size([width, height]) // width: 400px, height:450px\n            .padding(1);      // set padding to 1\n\n        const categories = dataset.children.map(d => d.name);\n\n        const root = treemap(hierarchy);\n        const colors = ['#1C1832', '#9E999D', '#F2259C', '#347EB4',\n            '#08ACB6', '#91BB91', '#BCD32F', '#75EDB8',\n            \"#89EE4B\", '#AD4FE8', '#D5AB61', '#BC3B3A',\n            '#F6A1F9', '#87ABBB', '#412433', '#56B870',\n            '#FDAB41', '#64624F']\n\n        const colorScale = d3.scaleOrdinal() // the scale function\n            .domain(categories) // the data\n            .range(colors)    // the way the data should be shown\n\n        svg.selectAll(\"rect\")\n            .data(root.leaves())\n            .enter()\n            .append(\"rect\")\n            .attr(\"x\", d => d.x0)\n            .attr(\"y\", d => d.y0)\n            .attr(\"width\", d => d.x1 - d.x0)\n            .attr(\"height\", d => d.y1 - d.y0)\n            .attr(\"fill\", d => colorScale(d.data.value))\n            .attr(\"font-size\", \"15px\")\n\n\n        svg.selectAll('text')\n            .data(root.leaves())\n            .enter()\n            .append('text')\n            .selectAll('tspan')\n            .data(d => {\n                { console.log(d.parent.data.name)}\n                return (d.parent.data.name.split(/(?=[A-Z][^A-Z])/g))// split the name of movie\n                    .map(v => {\n                        { console.log(v) }\n                        return {\n                            text: v,\n                            x0: d.x0,                        // keep x0 reference\n                            y0: d.y0                         // keep y0 reference\n                        }\n                    });\n            })\n            .enter()\n            .append('tspan')\n            .attr(\"x\", (d) => d.x0 + 5)\n            .attr(\"y\", (d, i) => d.y0 + 15 + (i * 2))       // offset by index \n            .text((d) => d.text)\n            .attr(\"font-size\", \"0.5em\")\n            .attr(\"fill\", \"white\");\n        \n            svg.selectAll('rect')\n            .on(\"mouseover\", function (d) {\n                { console.log(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value)}\n                tooltip.text(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value);\n                tooltip.style(\"visibility\", \"visible\");\n            })\n            .on(\"mousemove\", function (event, d) {\n                return tooltip.style(\"top\", (event.pageY - 10) + \"px\").style(\"left\", (event.pageX + 10) + \"px\");\n            })\n            .on(\"mouseout\", function () { return tooltip.style(\"visibility\", \"hidden\"); });\n\n\n    }\n\n\n    render() {\n        return (\n            <svg />\n        )\n    }\n\n}\n\nexport default TreeMap;\n"]},"metadata":{},"sourceType":"module"}