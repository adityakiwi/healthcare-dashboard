{"ast":null,"code":"import _classCallCheck from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import*as d3 from'd3';import*as d3l from'd3-svg-legend';var WaffleChart=/*#__PURE__*/function(_React$Component){_inherits(WaffleChart,_React$Component);var _super=_createSuper(WaffleChart);function WaffleChart(props){var _this;_classCallCheck(this,WaffleChart);_this=_super.call(this,props);_this.removeExistingBars=_this.removeExistingBars.bind(_assertThisInitialized(_this));_this.createBarChart=_this.createBarChart.bind(_assertThisInitialized(_this));_this.state={svg:null,width:0,height:0};return _this;}_createClass(WaffleChart,[{key:\"componentDidMount\",value:function componentDidMount(){var width=this.props.size[0];var height=this.props.size[1];// var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n//     width = owidth - margin.left - margin.right,\n//     height = oheight - margin.top - margin.bottom;\nvar svg=d3.select(\"body\").select(\"#wc\").select(\"svg\").attr(\"width\",width).attr(\"height\",height).append(\"g\");// .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\nthis.setState({svg:svg,width:width,height:height});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.removeExistingBars();this.createBarChart();}},{key:\"midpoint\",value:function midpoint(range){return range[0]+(range[1]-range[0])/2.0;}},{key:\"removeExistingBars\",value:function removeExistingBars(){var svg=this.state.svg;svg.selectAll(\"*\").remove();}},{key:\"createBarChart\",value:function createBarChart(){var svg=this.state.svg;var width=this.state.width;var height=this.state.height;var dataset=this.props.data;var selector=this.props.selector;var arr=[];dataset.forEach(function(d){d.values.forEach(function(e){var o={};o.diagnosis=d.diagnosis;o.age=e.age;o.total=e.value;arr.push(o);});});var selectordata=[[12,18],[18,21],[22,35],[36,55],[55,65],[65,75],[75,100]];console.log(\"arr\",arr);console.log(selectordata[selector][0]);console.log(selectordata[selector][1]);var arr_filtered=arr.filter(function(e){return e.age>=selectordata[selector][0]&&e.age<=selectordata[selector][1];});console.log(arr_filtered);var output=[];arr_filtered.forEach(function(item){var exist=output.filter(function(v,i){return v.diagnosis==item.diagnosis;});if(exist.length){var index=output.indexOf(exist[0]);var total=output[index].total+item.total;Object.assign(output[index],item);output[index].total=total;}else{if(typeof item.value=='string'){item.value=[item.value];}output.push(item);}});console.log(\"output\",output);var output_zero=output.filter(function(e){return e.total!=0;});console.log(\"output2\",output_zero);var data=output_zero;// var tooltip = d3.select(\"body\")\n//     .append(\"div\")\n//     .style(\"position\", \"absolute\")\n//     .style(\"z-index\", \"10\")\n//     .style(\"visibility\", \"hidden\")\n//     .style(\"color\", \"white\")\n//     .style(\"padding\", \"8px\")\n//     .style(\"background-color\", \"rgba(0, 0, 0, 0.75)\")\n//     .style(\"border-radius\", \"6px\")\n//     .style(\"font\", \"12px sans-serif\")\n//     .text(\"tooltip\");\nconsole.log(\"the incoming data\",data);var total=0;var widthSquares=20,heightSquares=5,squareSize=25,squareValue=0,gap=1,theData=[];var color=d3.scaleOrdinal(d3.schemeCategory10);//total\ntotal=d3.sum(data,function(d){return d.total;});//value of a square\nsquareValue=total/(widthSquares*heightSquares);//remap data\ndata.forEach(function(d,i){console.log(\"dataeach\",d);console.log(\"index\",i);d.total=+d.total;// d.units = (Math.floor(d.total / squareValue)) < 1 ? 1 : (Math.floor(d.total / squareValue));\nd.units=Math.floor(d.total/squareValue);theData=theData.concat(Array(d.units+1).join(1).split('').map(function(){return{squareValue:squareValue,units:d.units,total:d.total,groupIndex:i};}));});width=squareSize*widthSquares+widthSquares*gap+25;height=squareSize*heightSquares+heightSquares*gap+25;console.log(\"end\");console.log(theData);svg.append(\"g\").attr(\"width\",width).attr(\"height\",height).append(\"g\").selectAll(\"div\").data(theData).enter().append(\"rect\").attr(\"width\",squareSize).attr(\"height\",squareSize).attr(\"fill\",function(d){{console.log(d);}return color(data[d.groupIndex].diagnosis);}).attr(\"x\",function(d,i){//group n squares for column\nvar col=Math.floor(i/heightSquares);return col*squareSize+col*gap;}).attr(\"y\",function(d,i){var row=i%heightSquares;return heightSquares*squareSize-(row*squareSize+row*gap);}).append(\"title\").text(function(d,i){return\"diagnosis range: \"+data[d.groupIndex].diagnosis+\" | \"+d.total+\" , \"+d.units+\"%\";});// .on(\"mouseover\", function (d) {\n//     tooltip.text(\"diagnosis range: \" + data[d.groupIndex].diagnosis + \" | \" + d.total + \" , \" + d.units + \"%\");\n//     tooltip.style(\"visibility\", \"visible\");\n// })\n// .on(\"mousemove\", function (event, d) {\n//     return tooltip.style(\"top\", (event.pageY - 10) + \"px\").style(\"left\", (event.pageX + 10) + \"px\");\n// })\n// .on(\"mouseout\", function () { return tooltip.style(\"visibility\", \"hidden\"); });\nvar legend=d3l.legendColor().scale(color).shape('circle').orient('vertical').labelOffset(5);svg.append(\"g\").attr(\"class\",\"legend\").attr(\"transform\",\"translate(\"+(width-10)+\", \"+10+\")\").style(\"font-size\",\"12\");svg.select(\".legend\").call(legend);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"svg\",null);}}]);return WaffleChart;}(React.Component);export default WaffleChart;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/WaffleChart.js"],"names":["React","d3","d3l","WaffleChart","props","removeExistingBars","bind","createBarChart","state","svg","width","height","size","select","attr","append","setState","range","selectAll","remove","dataset","data","selector","arr","forEach","d","values","e","o","diagnosis","age","total","value","push","selectordata","console","log","arr_filtered","filter","output","item","exist","v","i","length","index","indexOf","Object","assign","output_zero","widthSquares","heightSquares","squareSize","squareValue","gap","theData","color","scaleOrdinal","schemeCategory10","sum","units","Math","floor","concat","Array","join","split","map","groupIndex","enter","col","row","text","legend","legendColor","scale","shape","orient","labelOffset","style","call","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport * as d3l from 'd3-svg-legend'\n\nclass WaffleChart extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeExistingBars = this.removeExistingBars.bind(this);\n        this.createBarChart = this.createBarChart.bind(this)\n        this.state = {\n            svg: null,\n            width: 0,\n            height: 0\n        };\n\n    }\n    componentDidMount() {\n        const width = this.props.size[0]\n        const height = this.props.size[1]\n\n        // var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n        //     width = owidth - margin.left - margin.right,\n        //     height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#wc\").select(\"svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .append(\"g\")\n            // .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n        this.setState({ svg, width, height });\n    }\n    componentDidUpdate() {\n        this.removeExistingBars();\n        this.createBarChart();\n    }\n\n    midpoint(range) {\n        return range[0] + (range[1] - range[0]) / 2.0;\n    }\n\n    removeExistingBars() {\n        const { svg } = this.state;\n\n        svg.selectAll(\"*\").remove();\n\n    }\n\n    createBarChart() {\n        const { svg } = this.state;\n        let { width } = this.state;\n        let { height } = this.state;\n\n        const dataset = this.props.data\n\n        const selector = this.props.selector\n\n        let arr = []\n\n\n        dataset.forEach(function (d) {\n            d.values.forEach(function (e) {\n                let o = {}\n                o.diagnosis = d.diagnosis\n                o.age = e.age\n                o.total = e.value\n                arr.push(o)\n            })\n        });\n\n        let selectordata = [[12, 18], [18, 21], [22, 35], [36, 55], [55, 65], [65, 75], [75, 100]]\n        console.log(\"arr\", arr)\n        console.log(selectordata[selector][0])\n        console.log(selectordata[selector][1])\n        let arr_filtered = arr.filter(function (e) {\n            return e.age >= selectordata[selector][0] && e.age <= selectordata[selector][1];\n        });\n        console.log(arr_filtered)\n        let output = []\n\n        arr_filtered.forEach(function (item) {\n            var exist = output.filter(function (v, i) {\n                return v.diagnosis == item.diagnosis\n            });\n            if (exist.length) {\n                var index = output.indexOf(exist[0]);\n                var total = output[index].total + item.total;\n                Object.assign(output[index], item);\n                output[index].total = total;\n            } else {\n                if (typeof item.value == 'string') {\n                    item.value = [item.value];\n                }\n                output.push(item);\n            }\n        });\n        console.log(\"output\", output)\n        let output_zero = output.filter(function (e) {\n            return e.total != 0;\n        });\n        console.log(\"output2\", output_zero)\n        let data =  output_zero\n\n        // var tooltip = d3.select(\"body\")\n        //     .append(\"div\")\n        //     .style(\"position\", \"absolute\")\n        //     .style(\"z-index\", \"10\")\n        //     .style(\"visibility\", \"hidden\")\n        //     .style(\"color\", \"white\")\n        //     .style(\"padding\", \"8px\")\n        //     .style(\"background-color\", \"rgba(0, 0, 0, 0.75)\")\n        //     .style(\"border-radius\", \"6px\")\n        //     .style(\"font\", \"12px sans-serif\")\n        //     .text(\"tooltip\");\n\n        console.log(\"the incoming data\", data)\n        var total = 0;\n        var\n            widthSquares = 20,\n            heightSquares = 5,\n            squareSize = 25,\n            squareValue = 0,\n            gap = 1,\n            theData = [];\n\n        var color = d3.scaleOrdinal(d3.schemeCategory10);\n\n        //total\n        total = d3.sum(data, function (d) { return d.total; });\n\n        //value of a square\n        squareValue = total / (widthSquares * heightSquares);\n\n        //remap data\n        data.forEach(function (d, i) {\n\n            console.log(\"dataeach\", d)\n            console.log(\"index\", i)\n            d.total = +d.total;\n            // d.units = (Math.floor(d.total / squareValue)) < 1 ? 1 : (Math.floor(d.total / squareValue));\n            d.units = (Math.floor(d.total / squareValue));\n            theData = theData.concat(\n                Array(d.units + 1).join(1).split('').map(function () {\n                    return {\n\n                        squareValue: squareValue,\n                        units: d.units,\n                        total: d.total,\n                        groupIndex: i\n\n                    };\n                })\n            );\n        });\n\n        width = (squareSize * widthSquares) + widthSquares * gap + 25;\n        height = (squareSize * heightSquares) + heightSquares * gap + 25;\n        console.log(\"end\")\n        console.log(theData)\n        svg.append(\"g\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .append(\"g\")\n            .selectAll(\"div\")\n            .data(theData)\n            .enter()\n            .append(\"rect\")\n            .attr(\"width\", squareSize)\n            .attr(\"height\", squareSize)\n            .attr(\"fill\", function (d) {\n                { console.log(d) }\n                return color(data[d.groupIndex].diagnosis);\n            })\n            .attr(\"x\", function (d, i) {\n                //group n squares for column\n                let col = Math.floor(i / heightSquares);\n                return (col * squareSize) + (col * gap);\n            })\n            .attr(\"y\", function (d, i) {\n                let row = i % heightSquares;\n                return (heightSquares * squareSize) - ((row * squareSize) + (row * gap))\n            })\n            .append(\"title\")\n            .text(function (d, i) {\n                return \"diagnosis range: \" + data[d.groupIndex].diagnosis + \" | \" + d.total + \" , \" + d.units + \"%\"\n            })\n            // .on(\"mouseover\", function (d) {\n            //     tooltip.text(\"diagnosis range: \" + data[d.groupIndex].diagnosis + \" | \" + d.total + \" , \" + d.units + \"%\");\n            //     tooltip.style(\"visibility\", \"visible\");\n            // })\n            // .on(\"mousemove\", function (event, d) {\n            //     return tooltip.style(\"top\", (event.pageY - 10) + \"px\").style(\"left\", (event.pageX + 10) + \"px\");\n            // })\n            // .on(\"mouseout\", function () { return tooltip.style(\"visibility\", \"hidden\"); });\n\n        var legend = d3l.legendColor()\n            .scale(color)\n            .shape('circle')\n            .orient('vertical')\n            .labelOffset(5)\n\n\n        svg.append(\"g\")\n            .attr(\"class\", \"legend\")\n            .attr(\"transform\", \"translate(\" + (width - 10) + \", \" + 10 + \")\")\n            .style(\"font-size\", \"12\")\n\n        svg.select(\".legend\")\n            .call(legend);\n        \n    }\n\n\n\n    render() {\n        return (\n            <svg />\n        )\n    }\n\n}\n\nexport default WaffleChart;\n"]},"metadata":{},"sourceType":"module"}