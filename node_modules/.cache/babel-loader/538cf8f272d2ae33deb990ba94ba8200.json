{"ast":null,"code":"import _classCallCheck from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import*as d3 from'd3';// import './GroupedBarChart.css'\nimport*as d3l from'd3-svg-legend';var GroupedBarChart=/*#__PURE__*/function(_React$Component){_inherits(GroupedBarChart,_React$Component);var _super=_createSuper(GroupedBarChart);function GroupedBarChart(props){var _this;_classCallCheck(this,GroupedBarChart);_this=_super.call(this,props);_this.removeExistingBars=_this.removeExistingBars.bind(_assertThisInitialized(_this));_this.createBarChart=_this.createBarChart.bind(_assertThisInitialized(_this));_this.state={svg:null,div:null,width:null,height:null,margin:null};return _this;}_createClass(GroupedBarChart,[{key:\"componentDidMount\",value:function componentDidMount(){var owidth=this.props.size[0];var oheight=this.props.size[1];var margin={top:20,right:0,bottom:20,left:70},width=owidth-margin.left-margin.right,height=oheight-margin.top-margin.bottom;var svg=d3.select(\"body\").select(\"#gbc\").select(\"svg\").attr(\"width\",width+margin.left+margin.right).attr(\"height\",height+margin.top+margin.bottom).append(\"g\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");var div=d3.select(\"body\").select(\"#gbc\").append(\"div\").style(\"position\",\"absolute\").style(\"z-index\",\"10\").style(\"visibility\",\"hidden\").style(\"color\",\"white\").style(\"padding\",\"8px\").style(\"background-color\",\"rgba(0, 0, 0, 0.75)\").style(\"border-radius\",\"6px\").style(\"font\",\"12px sans-serif\").text(\"tooltip\");this.setState({svg:svg,div:div,width:width,height:height,margin:margin});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.removeExistingBars();this.createBarChart();}},{key:\"midpoint\",value:function midpoint(range){return range[0]+(range[1]-range[0])/2.0;}},{key:\"removeExistingBars\",value:function removeExistingBars(){var svg=this.state.svg;svg.selectAll(\"*\").remove();}},{key:\"createBarChart\",value:function createBarChart(){var svg=this.state.svg;var div=this.state.div;var width=this.state.width;var height=this.state.height;var margin=this.state.margin;var data=this.props.data;var scale=this.props.scale.logarithmic;var label=this.props.selector;console.log(\"data\",data);var dnames=data.map(function(d){return d.diagnosis;});var gname=data[0].values.map(function(d){return d.distribution;});console.log(\"dname\",dnames);console.log(\"gname\",gname);function getKeyByValue(object,value){return Object.keys(object).find(function(key){return object[key]===value;});}var xScale=d3.scaleBand().range([0,width])// output\n.padding(0.1);var yScale;if(scale){console.log(\"logarithmic\");console.log(scale);yScale=d3.scaleLog().base(Math.E).domain([Math.exp(0),Math.exp(9)]).range([height,0]);}else{console.log(\"logarithmic\");console.log(scale);yScale=d3.scaleLinear().range([height,0]);// output\nyScale.domain([0,d3.max(data,function(key){return d3.max(key.values,function(d){return d.value;});})]);}var color=d3.scaleOrdinal().domain(gname).range([\"#60a3bc\",\"#e55039\",\"#4a69bd\",\"#f6b93b\",\"#78e08f\",\"#0a3d62\",\"#b71540\",\"#0c2461\",\"#e58e26\",\"#079992\",\"#3c6382\",\"#eb2f06\",\"#1e3799\",\"#fa983a\",\"#38ada9\",\"#82ccdd\",\"#f8c291\",\"#6a89cc\",\"#fad390\",\"#b8e994\"]);console.log(\"graphdata\",data);var xScale1=d3.scaleBand();xScale.domain(dnames);xScale1.domain(gname).rangeRound([0,xScale.bandwidth()]);svg.append(\"g\").attr(\"class\",\"x axis\").attr(\"transform\",\"translate(0,\"+height+\")\").call(d3.axisBottom(xScale));svg.append(\"g\").attr(\"class\",\"y axis\").call(d3.axisLeft(yScale).tickFormat(d3.formatPrefix(\".0\",1e1)));var legend=d3l.legendColor().scale(color).shape('circle').orient('vertical').labelOffset(5);svg.append(\"g\").attr(\"class\",\"legend\").attr(\"transform\",\"translate(\"+(width-100)+\", \"+20+\")\");svg.select(\".legend\").call(legend);var slice=svg.selectAll(\".slice\").data(data).enter().append(\"g\").attr(\"class\",\"g\").attr(\"transform\",function(d){return\"translate(\"+xScale(d.diagnosis)+\",0)\";});var colors=[\"#60a3bc\",\"#e55039\",\"#4a69bd\",\"#f6b93b\",\"#78e08f\",\"#0a3d62\",\"#b71540\",\"#0c2461\",\"#e58e26\",\"#079992\",\"#3c6382\",\"#eb2f06\",\"#1e3799\",\"#fa983a\",\"#38ada9\",\"#82ccdd\",\"#f8c291\",\"#6a89cc\",\"#fad390\",\"#b8e994\"];slice.selectAll(\"rect\").data(function(d){return d.values;}).enter().append(\"rect\").attr(\"width\",xScale1.bandwidth()).attr(\"x\",function(d){{console.log(\"x\",d.distribution);}return xScale1(d.distribution);}).attr(\"y\",function(d){{console.log(d.value);}return yScale(d.value);}).style(\"fill\",function(d,i){return colors[i];}).attr(\"height\",function(d){return height-yScale(d.value);}).on(\"mouseover\",function(d){console.log(d.path[0].__data__);div.text(\"Gender: \"+d.path[0].__data__.distribution+\": \"+\"Amount: \"+d.path[0].__data__.value);div.style(\"visibility\",\"visible\");}).on(\"mousemove\",function(event,d){return div.style(\"top\",event.pageY-10+\"px\").style(\"left\",event.pageX+10+\"px\");}).on(\"mouseout\",function(){return div.style(\"visibility\",\"hidden\");});var size=1;svg.selectAll(\"g\").data(data).enter().append(\"text\").attr(\"x\",10).attr(\"y\",function(d,i){return 10;})// 100 is where the first dot appears. 25 is the distance between dots\n.style(\"fill\",function(d){return color(d.distribution);}).text(function(d){return d.distribution;}).attr(\"text-anchor\",\"left\");var xmid=xScale.range()[0]+(xScale.range()[1]-xScale.range()[0])/2.0;var ymid=yScale.range()[0]+(yScale.range()[1]-yScale.range()[0])/2.0;var xtitle=svg.append('text').attr('class','axis-title').text('Diseases');xtitle.attr('text-anchor','middle');xtitle.attr('x',xmid);xtitle.attr('y',height+40);var ytitle=svg.append('text').attr('class','axis-title').text('Number of Patients');ytitle.attr('x',xmid);ytitle.attr('y',height+40);ytitle.attr('dy','1.75ex');ytitle.attr('text-anchor','middle');ytitle.attr('transform','rotate(-90)');var tooltip=d3.select('#container').append('div').attr('class','tooltip').style('opacity',0);function mouseover(){d3.select(this).attr(\"opacity\",.5);}function mouseout(){d3.select(this).attr(\"opacity\",1);}}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"svg\",null);}}]);return GroupedBarChart;}(React.Component);export default GroupedBarChart;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Wesbite/dashboard/src/views/dashboard/DashboardView/d3/GroupedBarChart.js"],"names":["React","d3","d3l","GroupedBarChart","props","removeExistingBars","bind","createBarChart","state","svg","div","width","height","margin","owidth","size","oheight","top","right","bottom","left","select","attr","append","style","text","setState","range","selectAll","remove","data","scale","logarithmic","label","selector","console","log","dnames","map","d","diagnosis","gname","values","distribution","getKeyByValue","object","value","Object","keys","find","key","xScale","scaleBand","padding","yScale","scaleLog","base","Math","E","domain","exp","scaleLinear","max","color","scaleOrdinal","xScale1","rangeRound","bandwidth","call","axisBottom","axisLeft","tickFormat","formatPrefix","legend","legendColor","shape","orient","labelOffset","slice","enter","colors","i","on","path","__data__","event","pageY","pageX","xmid","ymid","xtitle","ytitle","tooltip","mouseover","mouseout","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\n// import './GroupedBarChart.css'\nimport * as d3l from 'd3-svg-legend'\n\nclass GroupedBarChart extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeExistingBars = this.removeExistingBars.bind(this);\n        this.createBarChart = this.createBarChart.bind(this)\n        this.state = {\n            svg: null,\n            div: null,\n            width: null,\n            height: null,\n            margin: null\n        };\n    }\n\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 0, bottom: 20, left: 70 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#gbc\").select(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        var div = d3.select(\"body\").select(\"#gbc\").append(\"div\")\n        .style(\"position\", \"absolute\")\n        .style(\"z-index\", \"10\")\n        .style(\"visibility\", \"hidden\")\n        .style(\"color\", \"white\")\n        .style(\"padding\", \"8px\")\n        .style(\"background-color\", \"rgba(0, 0, 0, 0.75)\")\n        .style(\"border-radius\", \"6px\")\n        .style(\"font\", \"12px sans-serif\")\n        .text(\"tooltip\");\n        this.setState({ svg, div, width, height, margin });\n    }\n\n    componentDidUpdate() {\n        this.removeExistingBars();\n        this.createBarChart();\n    }\n\n    midpoint(range) {\n        return range[0] + (range[1] - range[0]) / 2.0;\n    }\n\n    removeExistingBars() {\n        const { svg } = this.state;\n        svg.selectAll(\"*\").remove();\n    }\n\n    createBarChart() {\n        const { svg } = this.state;\n        var { div } = this.state;\n        const { width } = this.state;\n        const { height } = this.state;\n        const { margin } = this.state;\n\n\n        const data = this.props.data\n        const scale = this.props.scale.logarithmic\n        const label = this.props.selector\n\n        console.log(\"data\", data);\n        var dnames = data.map(function (d) { return d.diagnosis; });\n        var gname = data[0].values.map(function (d) { return d.distribution; });\n\n        console.log(\"dname\", dnames)\n        console.log(\"gname\", gname)\n\n\n        function getKeyByValue(object, value) {\n            return Object.keys(object).find(key => object[key] === value);\n        }\n\n        var xScale = d3.scaleBand()\n            .range([0, width]) // output\n            .padding(0.1)\n\n        var yScale;\n        if (scale) {\n            console.log(\"logarithmic\")\n            console.log(scale)\n            yScale = d3.scaleLog()\n                .base(Math.E)\n                .domain([Math.exp(0), Math.exp(9)])\n                .range([height, 0]);        }\n        else {\n            console.log(\"logarithmic\")\n            console.log(scale)\n            yScale = d3.scaleLinear()\n                .range([height, 0]); // output\n            yScale.domain([0, d3.max(data, function (key) { return d3.max(key.values, function (d) { return d.value; }); })]);\n        }\n\n\n        var color = d3.scaleOrdinal()\n        .domain(gname)\n        .range([\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\",\n                \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\",\n                \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\",\n                \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"]);\n\n        console.log(\"graphdata\", data)\n\n        var xScale1 = d3.scaleBand()\n\n        xScale.domain(dnames);\n        xScale1.domain(gname).rangeRound([0, xScale.bandwidth()]);\n\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(d3.axisBottom(xScale));\n\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(d3.axisLeft(yScale).tickFormat(d3.formatPrefix(\".0\",1e1)));\n\n        var legend = d3l.legendColor()\n            .scale(color)\n            .shape('circle')\n            .orient('vertical')\n            .labelOffset(5)\n\n        svg.append(\"g\")\n            .attr(\"class\", \"legend\")\n            .attr(\"transform\", \"translate(\" + (width-100) + \", \" + 20+\")\");\n\n        svg.select(\".legend\")\n            .call(legend);\n\n        var slice = svg.selectAll(\".slice\")\n            .data(data)\n            .enter().append(\"g\")\n            .attr(\"class\", \"g\")\n            .attr(\"transform\", function (d) { return \"translate(\" + xScale(d.diagnosis) + \",0)\"; });\n\n        var colors = [\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\",\n                      \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\",\n                      \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\",\n                      \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"];\n\n        slice.selectAll(\"rect\")\n            .data(function (d) { return d.values; })\n            .enter().append(\"rect\")\n            .attr(\"width\", xScale1.bandwidth())\n            .attr(\"x\", function (d) { { console.log(\"x\", d.distribution) } return xScale1(d.distribution); })\n            .attr(\"y\", function (d) { { console.log(d.value) } return yScale(d.value); })\n            .style(\"fill\", function (d,i) { return colors[i]; })\n            .attr(\"height\", function (d) { return height - yScale(d.value); })\n            .on(\"mouseover\", function (d) {\n                console.log(d.path[0].__data__)\n                div.text(\"Gender: \"+ d.path[0].__data__.distribution + \": \" + \"Amount: \"+ d.path[0].__data__.value);\n                div.style(\"visibility\", \"visible\");\n            })\n            .on(\"mousemove\", function (event, d) {\n                return div.style(\"top\", (event.pageY - 10) + \"px\").style(\"left\", (event.pageX + 10) + \"px\");\n            })\n            .on(\"mouseout\", function () { return div.style(\"visibility\", \"hidden\"); });\n\n        let size = 1\n        svg.selectAll(\"g\")\n            .data(data)\n            .enter()\n            .append(\"text\")\n            .attr(\"x\", 10)\n            .attr(\"y\", function (d, i) { return 10 }) // 100 is where the first dot appears. 25 is the distance between dots\n            .style(\"fill\", function (d) { return color(d.distribution) })\n            .text(function (d) { return d.distribution })\n            .attr(\"text-anchor\", \"left\")\n\n\n        const xmid = xScale.range()[0] + (xScale.range()[1] - xScale.range()[0]) / 2.0;\n        const ymid = yScale.range()[0] + (yScale.range()[1] - yScale.range()[0]) / 2.0;\n        const xtitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('Diseases');\n        xtitle.attr('text-anchor', 'middle');\n        xtitle.attr('x', xmid);\n        xtitle.attr('y', height + 40);\n        const ytitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('Number of Patients')\n        ytitle.attr('x', xmid);\n        ytitle.attr('y', height + 40);\n        ytitle.attr('dy', '1.75ex');\n        ytitle.attr('text-anchor', 'middle');\n        ytitle.attr('transform', 'rotate(-90)');\n\n        const tooltip = d3\n            .select('#container')\n            .append('div')\n            .attr('class', 'tooltip')\n            .style('opacity', 0);\n\n        function mouseover() {\n            d3.select(this).attr(\"opacity\", .5)\n        }\n\n        function mouseout() {\n            d3.select(this).attr(\"opacity\", 1);\n        }\n    }\n\n    render() {\n        return (\n            <svg/>\n        )\n    }\n}\n\nexport default GroupedBarChart;\n"]},"metadata":{},"sourceType":"module"}