{"ast":null,"code":"var _jsxFileName = \"/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/reports/DashboardView/GroupedBarChart.js\";\nimport React from 'react';\nimport * as d3 from 'd3';\nimport './GroupedBarChart.css';\n\nclass GroupedBarChart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.removeExistingBars = this.removeExistingBars.bind(this);\n    this.createBarChart = this.createBarChart.bind(this);\n    this.state = {\n      svg: null,\n      div: null\n    };\n  }\n\n  componentDidMount() {\n    const owidth = this.props.size[0];\n    const oheight = this.props.size[1];\n    var margin = {\n      top: 20,\n      right: 20,\n      bottom: 70,\n      left: 100\n    },\n        width = owidth - margin.left - margin.right,\n        height = oheight - margin.top - margin.bottom; // const svg = d3.select(\"body\").select(\"#gbc\")\n    // .append(\"svg\")\n    //     .attr(\"width\", width + margin.left + margin.right)\n    //     .attr(\"height\", height + margin.top + margin.bottom)\n    //     .append(\"g\")\n    //     .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n    const svg = d3.select(\"body\").select(\"#gbc\").classed(\"svg-container\", true) //container class to make it responsive\n    .select(\"svg\") //responsive SVG needs these 2 attributes and no width and height attr\n    .attr(\"preserveAspectRatio\", \"xMinYMin meet\").attr(\"viewBox\", \"0 0 600 400\") //class to make it responsive\n    .classed(\"svg-content-responsive\", true);\n    const div = d3.select(\"body\").select(\"#gbc\").append(\"div\").classed(\"svg-container\", true) //container class to make it responsive\n    .select(\"svg\") //responsive SVG needs these 2 attributes and no width and height attr\n    .attr(\"preserveAspectRatio\", \"xMinYMin meet\").attr(\"viewBox\", \"0 0 600 400\") //class to make it responsive\n    .attr(\"class\", \"tooltip-donut\").style(\"opacity\", 0);\n    this.setState({\n      svg,\n      div\n    });\n  }\n\n  componentDidUpdate() {\n    this.removeExistingBars();\n    this.createBarChart();\n  }\n\n  midpoint(range) {\n    return range[0] + (range[1] - range[0]) / 2.0;\n  }\n\n  removeExistingBars() {\n    const {\n      svg\n    } = this.state;\n    svg.selectAll(\"*\").remove();\n  }\n\n  createBarChart() {\n    const {\n      svg\n    } = this.state;\n    const {\n      div\n    } = this.state;\n    const data = this.props.data;\n    const owidth = this.props.size[0];\n    const oheight = this.props.size[1];\n    var margin = {\n      top: 20,\n      right: 20,\n      bottom: 70,\n      left: 100\n    },\n        width = owidth - margin.left - margin.right,\n        height = oheight - margin.top - margin.bottom;\n    console.log(\"data\", data);\n    var dnames = data.map(function (d) {\n      return d.diagnosis;\n    });\n    var gname = data[0].values.map(function (d) {\n      return d.distribution;\n    });\n    console.log(\"dname\", dnames);\n    console.log(\"gname\", gname);\n\n    function getKeyByValue(object, value) {\n      return Object.keys(object).find(key => object[key] === value);\n    }\n\n    var xScale = d3.scaleBand().range([0, width]) // output\n    .padding(0.1);\n    var yScale = d3.scaleLinear().range([height, 0]); // output\n\n    var color = d3.scaleOrdinal(d3.schemeCategory10);\n    console.log(\"graphdata\", data);\n    var xScale1 = d3.scaleBand();\n    xScale.domain(dnames);\n    xScale1.domain(gname).rangeRound([0, xScale.bandwidth()]);\n    yScale.domain([0, d3.max(data, function (key) {\n      return d3.max(key.values, function (d) {\n        return d.value;\n      });\n    })]);\n    svg.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(xScale));\n    svg.append(\"g\").attr(\"class\", \"y axis\").call(d3.axisLeft(yScale));\n    var slice = svg.selectAll(\".slice\").data(data).enter().append(\"g\").attr(\"class\", \"g\").attr(\"transform\", function (d) {\n      return \"translate(\" + xScale(d.diagnosis) + \",0)\";\n    });\n    slice.selectAll(\"rect\").data(function (d) {\n      return d.values;\n    }).enter().append(\"rect\").attr(\"width\", xScale1.bandwidth()).attr(\"x\", function (d) {\n      {\n        console.log(\"x\", d.distribution);\n      }\n      return xScale1(d.distribution);\n    }).attr(\"y\", function (d) {\n      {\n        console.log(d.value);\n      }\n      return yScale(d.value);\n    }).style(\"fill\", function (d) {\n      return color(d.distribution);\n    }).attr(\"height\", function (d) {\n      return height - yScale(d.value);\n    }).on(\"mouseover\", function (event, d) {\n      d3.select(this).transition().duration('50').attr('opacity', .50);\n      console.log(d, event); /// add to html\n\n      div.transition().duration(50).style(\"opacity\", 1);\n      div.html(\"Gender: \" + d.distribution + \"<br>\" + \"Amount: \" + d.value).style(\"left\", event.pageX - 30 + \"px\").style(\"top\", event.pageY - 15 + \"px\");\n    }).on(\"mouseout\", function (d) {\n      d3.select(this).transition().duration('50').attr('opacity', 1);\n      div.transition().duration('50').style(\"opacity\", 0);\n    });\n    let size = 1;\n    svg.selectAll(\"g\").data(data).enter().append(\"text\").attr(\"x\", 10).attr(\"y\", function (d, i) {\n      return 10;\n    }) // 100 is where the first dot appears. 25 is the distance between dots\n    .style(\"fill\", function (d) {\n      return color(d.distribution);\n    }).text(function (d) {\n      return d.distribution;\n    }).attr(\"text-anchor\", \"left\");\n    const xmid = xScale.range()[0] + (xScale.range()[1] - xScale.range()[0]) / 2.0; // const ymid = yScale.range()[0] + (yScale.range()[1] - yScale.range()[0]) / 2.0;\n\n    const xtitle = svg.append('text').attr('class', 'axis-title').text('X');\n    xtitle.attr('text-anchor', 'middle');\n    xtitle.attr('x', xmid);\n    xtitle.attr('y', height + 40);\n    const ytitle = svg.append('text').attr('class', 'axis-title').text('Y');\n    ytitle.attr('x', -210);\n    ytitle.attr('y', -80);\n    ytitle.attr('dy', '1.75ex');\n    ytitle.attr('text-anchor', 'middle');\n    ytitle.attr('transform', 'rotate(-90)');\n    const tooltip = d3.select('#container').append('div').attr('class', 'tooltip').style('opacity', 0);\n\n    function mouseover() {\n      d3.select(this).attr(\"opacity\", .5);\n    }\n\n    function mouseout() {\n      d3.select(this).attr(\"opacity\", 1);\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"svg\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 13\n      }\n    });\n  }\n\n}\n\nexport default GroupedBarChart;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/reports/DashboardView/GroupedBarChart.js"],"names":["React","d3","GroupedBarChart","Component","constructor","props","removeExistingBars","bind","createBarChart","state","svg","div","componentDidMount","owidth","size","oheight","margin","top","right","bottom","left","width","height","select","classed","attr","append","style","setState","componentDidUpdate","midpoint","range","selectAll","remove","data","console","log","dnames","map","d","diagnosis","gname","values","distribution","getKeyByValue","object","value","Object","keys","find","key","xScale","scaleBand","padding","yScale","scaleLinear","color","scaleOrdinal","schemeCategory10","xScale1","domain","rangeRound","bandwidth","max","call","axisBottom","axisLeft","slice","enter","on","event","transition","duration","html","pageX","pageY","i","text","xmid","xtitle","ytitle","tooltip","mouseover","mouseout","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport './GroupedBarChart.css'\n\nclass GroupedBarChart extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeExistingBars = this.removeExistingBars.bind(this);\n        this.createBarChart = this.createBarChart.bind(this)\n        this.state = {\n            svg: null,\n            div: null\n        };\n\n    }\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        // const svg = d3.select(\"body\").select(\"#gbc\")\n        // .append(\"svg\")\n        //     .attr(\"width\", width + margin.left + margin.right)\n        //     .attr(\"height\", height + margin.top + margin.bottom)\n        //     .append(\"g\")\n        //     .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n        const svg = d3.select(\"body\").select(\"#gbc\")\n            .classed(\"svg-container\", true) //container class to make it responsive\n            .select(\"svg\")\n            //responsive SVG needs these 2 attributes and no width and height attr\n            .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n            .attr(\"viewBox\", \"0 0 600 400\")\n            //class to make it responsive\n            .classed(\"svg-content-responsive\", true); \n\n\n        const div = d3.select(\"body\").select(\"#gbc\").append(\"div\")\n            .classed(\"svg-container\", true) //container class to make it responsive\n            .select(\"svg\")\n            //responsive SVG needs these 2 attributes and no width and height attr\n            .attr(\"preserveAspectRatio\", \"xMinYMin meet\")\n            .attr(\"viewBox\", \"0 0 600 400\")\n            //class to make it responsive\n            .attr(\"class\", \"tooltip-donut\")\n            .style(\"opacity\", 0);\n\n        this.setState({ svg, div });\n    }\n    componentDidUpdate() {\n        this.removeExistingBars();\n        this.createBarChart();\n    }\n\n    midpoint(range) {\n        return range[0] + (range[1] - range[0]) / 2.0;\n    }\n\n    removeExistingBars() {\n        const { svg } = this.state;\n\n        svg.selectAll(\"*\").remove();\n\n    }\n\n    createBarChart() {\n        const { svg } = this.state;\n        const { div } = this.state;\n\n        const data = this.props.data\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        console.log(\"data\", data);\n        var dnames = data.map(function (d) { return d.diagnosis; });\n        var gname = data[0].values.map(function (d) { return d.distribution; });\n\n        console.log(\"dname\", dnames)\n        console.log(\"gname\", gname)\n\n\n        function getKeyByValue(object, value) {\n            return Object.keys(object).find(key => object[key] === value);\n        }\n\n\n        var xScale = d3.scaleBand()\n            .range([0, width]) // output\n            .padding(0.1)\n\n        var yScale = d3.scaleLinear()\n            .range([height, 0]); // output\n\n        var color = d3.scaleOrdinal(d3.schemeCategory10)\n\n        console.log(\"graphdata\", data)\n\n        var xScale1 = d3.scaleBand()\n\n        xScale.domain(dnames);\n        xScale1.domain(gname).rangeRound([0, xScale.bandwidth()]);\n\n        yScale.domain([0, d3.max(data, function (key) { return d3.max(key.values, function (d) { return d.value; }); })]);\n\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(d3.axisBottom(xScale));\n\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(d3.axisLeft(yScale));\n\n        var slice = svg.selectAll(\".slice\")\n            .data(data)\n            .enter().append(\"g\")\n            .attr(\"class\", \"g\")\n            .attr(\"transform\", function (d) { return \"translate(\" + xScale(d.diagnosis) + \",0)\"; });\n\n\n        slice.selectAll(\"rect\")\n            .data(function (d) { return d.values; })\n            .enter().append(\"rect\")\n            .attr(\"width\", xScale1.bandwidth())\n            .attr(\"x\", function (d) { { console.log(\"x\", d.distribution) } return xScale1(d.distribution); })\n            .attr(\"y\", function (d) { { console.log(d.value) } return yScale(d.value); })\n            .style(\"fill\", function (d) { return color(d.distribution) })\n            .attr(\"height\", function (d) { return height - yScale(d.value); })\n            .on(\"mouseover\", function (event, d) {\n                d3.select(this).transition()\n                    .duration('50')\n                    .attr('opacity', .50);\n                console.log(d, event)\n                /// add to html\n                div.transition()\n                    .duration(50)\n                    .style(\"opacity\", 1)\n\n                div.html(\"Gender: \" + d.distribution + \"<br>\" + \"Amount: \" + d.value)\n                    .style(\"left\", (event.pageX - 30) + \"px\")\n                    .style(\"top\", (event.pageY - 15) + \"px\")\n\n            })\n            .on(\"mouseout\", function (d) {\n                d3.select(this).transition()\n                    .duration('50')\n                    .attr('opacity', 1)\n                div.transition()\n                    .duration('50')\n                    .style(\"opacity\", 0)\n            })\n\n        let size = 1\n        svg.selectAll(\"g\")\n            .data(data)\n            .enter()\n            .append(\"text\")\n            .attr(\"x\", 10)\n            .attr(\"y\", function (d, i) { return 10 }) // 100 is where the first dot appears. 25 is the distance between dots\n            .style(\"fill\", function (d) { return color(d.distribution) })\n            .text(function (d) { return d.distribution })\n            .attr(\"text-anchor\", \"left\")\n\n        const xmid = xScale.range()[0] + (xScale.range()[1] - xScale.range()[0]) / 2.0;\n        // const ymid = yScale.range()[0] + (yScale.range()[1] - yScale.range()[0]) / 2.0;\n        const xtitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('X');\n        xtitle.attr('text-anchor', 'middle');\n        xtitle.attr('x', xmid);\n        xtitle.attr('y', height + 40);\n        const ytitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('Y')\n        ytitle.attr('x', -210);\n        ytitle.attr('y', -80);\n        ytitle.attr('dy', '1.75ex');\n        ytitle.attr('text-anchor', 'middle');\n        ytitle.attr('transform', 'rotate(-90)');\n\n        const tooltip = d3\n            .select('#container')\n            .append('div')\n            .attr('class', 'tooltip')\n            .style('opacity', 0);\n\n        function mouseover() {\n            d3.select(this).attr(\"opacity\", .5)\n\n        }\n\n        function mouseout() {\n            d3.select(this).attr(\"opacity\", 1);\n        }\n\n    }\n\n\n    \n    render() {\n        return (\n            <svg/>\n        )\n    }\n\n}\n\nexport default GroupedBarChart;\n"]},"metadata":{},"sourceType":"module"}