{"ast":null,"code":"var _jsxFileName = \"/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/TreeMap.js\";\nimport React from 'react';\nimport * as d3 from 'd3';\nimport { range } from 'd3';\n\nclass TreeMap extends React.Component {\n  constructor(props) {\n    super(props);\n    this.removeMap = this.removeMap.bind(this);\n    this.createMap = this.createMap.bind(this);\n    this.state = {\n      svg: null,\n      width: null,\n      height: null\n    };\n  }\n\n  componentDidMount() {\n    const owidth = this.props.size[0];\n    const oheight = this.props.size[1];\n    var margin = {\n      top: 20,\n      right: 20,\n      bottom: 70,\n      left: 100\n    },\n        width = owidth - margin.left - margin.right,\n        height = oheight - margin.top - margin.bottom;\n    const svg = d3.select(\"body\").select(\"#tm\").select(\"svg\").attr(\"width\", width).attr(\"height\", diameter).attr(\"class\", \"bubble\");\n    this.setState({\n      svg\n    });\n    this.setState({\n      width\n    });\n    this.setState({\n      height\n    });\n  }\n\n  componentDidUpdate() {\n    this.removeMap();\n    this.createMap();\n  }\n\n  removeMap() {\n    const {\n      svg\n    } = this.state;\n    svg.selectAll(\"*\").remove();\n  }\n\n  createMap() {\n    const {\n      svg\n    } = this.state;\n    const {\n      width\n    } = this.state;\n    const {\n      height\n    } = this.state;\n    const rawdata = this.props.data;\n    let dataset = {\n      name: \"q8\",\n      \"children\": []\n    };\n    rawdata.forEach(function (d) {\n      dataset[\"children\"].push({\n        name: d.diagnosis,\n        children: d.values\n      });\n    });\n    let data = dataset;\n    console.log(data);\n    const hierarchy = d3.hierarchy(data).sum(d => d.value) //sum every child's values\n    .sort((a, b) => b.value - a.value); // and sort them in descending order \n\n    const treemap = d3.treemap().size([width, height]) // width: 400px, height:450px\n    .padding(1); // set padding to 1\n\n    const categories = dataset.children.map(d => d.name);\n    const root = treemap(hierarchy);\n    const colors = ['#1C1832', '#9E999D', '#F2259C', '#347EB4', '#08ACB6', '#91BB91', '#BCD32F', '#75EDB8', \"#89EE4B\", '#AD4FE8', '#D5AB61', '#BC3B3A', '#F6A1F9', '#87ABBB', '#412433', '#56B870', '#FDAB41', '#64624F'];\n    const colorScale = d3.scaleOrdinal() // the scale function\n    .domain(categories) // the data\n    .range(colors); // the way the data should be shown\n\n    svg.selectAll(\"rect\").data(root.leaves()).enter().append(\"rect\").attr(\"x\", d => d.x0).attr(\"y\", d => d.y0).attr(\"width\", d => d.x1 - d.x0).attr(\"height\", d => d.y1 - d.y0).attr(\"fill\", d => colorScale(d.data.value)).attr(\"font-size\", \"15px\");\n    svg.selectAll('text').data(root.leaves()).enter().append('text').selectAll('tspan').data(d => {\n      {\n        console.log(d.parent.data.name);\n      }\n      return d.parent.data.name.split(/(?=[A-Z][^A-Z])/g). // split the name of movie\n      map(v => {\n        {\n          console.log(v);\n        }\n        return {\n          text: v,\n          x0: d.x0,\n          // keep x0 reference\n          y0: d.y0 // keep y0 reference\n\n        };\n      });\n    }).enter().append('tspan').attr(\"x\", d => d.x0 + 5).attr(\"y\", (d, i) => d.y0 + 15 + i * 2) // offset by index \n    .text(d => d.text).attr(\"font-size\", \"0.5em\").attr(\"fill\", \"white\");\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"svg\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 13\n      }\n    });\n  }\n\n}\n\nexport default TreeMap;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/TreeMap.js"],"names":["React","d3","range","TreeMap","Component","constructor","props","removeMap","bind","createMap","state","svg","width","height","componentDidMount","owidth","size","oheight","margin","top","right","bottom","left","select","attr","diameter","setState","componentDidUpdate","selectAll","remove","rawdata","data","dataset","name","forEach","d","push","diagnosis","children","values","console","log","hierarchy","sum","value","sort","a","b","treemap","padding","categories","map","root","colors","colorScale","scaleOrdinal","domain","leaves","enter","append","x0","y0","x1","y1","parent","split","v","text","i","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport { range } from 'd3';\n\nclass TreeMap extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeMap = this.removeMap.bind(this);\n        this.createMap = this.createMap.bind(this)\n        this.state = {\n            svg: null,\n            width: null,\n            height: null,\n        };\n\n    }\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#tm\").select(\"svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", diameter)\n            .attr(\"class\", \"bubble\");\n\n        this.setState({ svg });\n        this.setState({ width });\n        this.setState({ height });\n\n    }\n    componentDidUpdate() {\n        this.removeMap();\n        this.createMap();\n    }\n\n\n    removeMap() {\n        const { svg } = this.state;\n\n        svg.selectAll(\"*\").remove();\n\n    }\n\n    createMap() {\n        const { svg } = this.state;\n        const { width } = this.state;\n        const { height } = this.state;\n\n        const rawdata = this.props.data\n        let dataset = {\n            name: \"q8\",\n            \"children\": []\n        };\n\n        rawdata.forEach(function (d) {\n            dataset[\"children\"].push({\n                name: d.diagnosis,\n                children: d.values\n            })\n        })\n        let data = dataset\n        console.log(data)\n        const hierarchy = d3.hierarchy(data)\n            .sum(d => d.value)  //sum every child's values\n            .sort((a, b) => b.value - a.value) // and sort them in descending order \n        const treemap = d3.treemap()\n            .size([width, height]) // width: 400px, height:450px\n            .padding(1);      // set padding to 1\n\n        const categories = dataset.children.map(d => d.name);\n\n        const root = treemap(hierarchy);\n        const colors = ['#1C1832', '#9E999D', '#F2259C', '#347EB4',\n            '#08ACB6', '#91BB91', '#BCD32F', '#75EDB8',\n            \"#89EE4B\", '#AD4FE8', '#D5AB61', '#BC3B3A',\n            '#F6A1F9', '#87ABBB', '#412433', '#56B870',\n            '#FDAB41', '#64624F']\n\n        const colorScale = d3.scaleOrdinal() // the scale function\n            .domain(categories) // the data\n            .range(colors)    // the way the data should be shown\n\n        svg.selectAll(\"rect\")\n            .data(root.leaves())\n            .enter()\n            .append(\"rect\")\n            .attr(\"x\", d => d.x0)\n            .attr(\"y\", d => d.y0)\n            .attr(\"width\", d => d.x1 - d.x0)\n            .attr(\"height\", d => d.y1 - d.y0)\n            .attr(\"fill\", d => colorScale(d.data.value))\n            .attr(\"font-size\", \"15px\")\n\n\n        svg.selectAll('text')\n            .data(root.leaves())\n            .enter()\n            .append('text')\n            .selectAll('tspan')\n            .data(d => {\n                { console.log(d.parent.data.name)}\n                return (d.parent.data.name.split(/(?=[A-Z][^A-Z])/g))// split the name of movie\n                    .map(v => {\n                        { console.log(v) }\n                        return {\n                            text: v,\n                            x0: d.x0,                        // keep x0 reference\n                            y0: d.y0                         // keep y0 reference\n                        }\n                    });\n            })\n            .enter()\n            .append('tspan')\n            .attr(\"x\", (d) => d.x0 + 5)\n            .attr(\"y\", (d, i) => d.y0 + 15 + (i * 2))       // offset by index \n            .text((d) => d.text)\n            .attr(\"font-size\", \"0.5em\")\n            .attr(\"fill\", \"white\");\n\n    }\n\n\n    render() {\n        return (\n            <svg />\n        )\n    }\n\n}\n\nexport default TreeMap;\n"]},"metadata":{},"sourceType":"module"}