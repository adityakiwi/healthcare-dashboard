{"ast":null,"code":"var _jsxFileName = \"/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/TreeMap.js\";\nimport React from 'react';\nimport * as d3 from 'd3';\nimport { range } from 'd3';\n\nclass TreeMap extends React.Component {\n  constructor(props) {\n    super(props);\n    this.removeMap = this.removeMap.bind(this);\n    this.createMap = this.createMap.bind(this);\n    this.state = {\n      svg: null,\n      width: null,\n      height: null\n    };\n  }\n\n  componentDidMount() {\n    const owidth = this.props.size[0];\n    const oheight = this.props.size[1];\n    var margin = {\n      top: 20,\n      right: 20,\n      bottom: 70,\n      left: 100\n    },\n        width = owidth - margin.left - margin.right,\n        height = oheight - margin.top - margin.bottom;\n    const svg = d3.select(\"body\").select(\"#tm\").select(\"svg\").attr(\"width\", width).attr(\"height\", height);\n    this.setState({\n      svg\n    });\n    this.setState({\n      width\n    });\n    this.setState({\n      height\n    });\n  }\n\n  componentDidUpdate() {\n    this.removeMap();\n    this.createMap();\n  }\n\n  removeMap() {\n    const {\n      svg\n    } = this.state;\n    svg.selectAll(\"*\").remove();\n  }\n\n  createMap() {\n    const {\n      svg\n    } = this.state;\n    const {\n      width\n    } = this.state;\n    const {\n      height\n    } = this.state;\n    const {\n      div\n    } = this.state;\n    var tooltip = div.style(\"position\", \"absolute\").style(\"z-index\", \"10\").style(\"visibility\", \"hidden\").style(\"color\", \"white\").style(\"padding\", \"8px\").style(\"background-color\", \"rgba(0, 0, 0, 0.75)\").style(\"border-radius\", \"6px\").style(\"font\", \"12px sans-serif\").text(\"tooltip\");\n    const rawdata = this.props.data;\n    let dataset = {\n      name: \"q8\",\n      \"children\": []\n    };\n    rawdata.forEach(function (d) {\n      dataset[\"children\"].push({\n        name: d.diagnosis,\n        children: d.values\n      });\n    });\n    let data = dataset;\n    console.log(data);\n    const hierarchy = d3.hierarchy(data).sum(d => d.value) //sum every child's values\n    .sort((a, b) => b.value - a.value); // and sort them in descending order \n\n    const treemap = d3.treemap().size([width, height]) // width: 400px, height:450px\n    .padding(1); // set padding to 1\n\n    const categories = dataset.children.map(d => d.name);\n    const root = treemap(hierarchy);\n    const colors = ['#1C1832', '#9E999D', '#F2259C', '#347EB4', '#08ACB6', '#91BB91', '#BCD32F', '#75EDB8', \"#89EE4B\", '#AD4FE8', '#D5AB61', '#BC3B3A', '#F6A1F9', '#87ABBB', '#412433', '#56B870', '#FDAB41', '#64624F'];\n    const colorScale = d3.scaleOrdinal() // the scale function\n    .domain(categories) // the data\n    .range(colors); // the way the data should be shown\n\n    svg.selectAll(\"rect\").data(root.leaves()).enter().append(\"rect\").attr(\"x\", d => d.x0).attr(\"y\", d => d.y0).attr(\"width\", d => d.x1 - d.x0).attr(\"height\", d => d.y1 - d.y0).attr(\"fill\", d => colorScale(d.data.value)).attr(\"font-size\", \"15px\");\n    svg.selectAll('text').data(root.leaves()).enter().append('text').selectAll('tspan').data(d => {\n      {\n        console.log(d.parent.data.name);\n      }\n      return d.parent.data.name.split(/(?=[A-Z][^A-Z])/g). // split the name of movie\n      map(v => {\n        {\n          console.log(v);\n        }\n        return {\n          text: v,\n          x0: d.x0,\n          // keep x0 reference\n          y0: d.y0 // keep y0 reference\n\n        };\n      });\n    }).enter().append('tspan').attr(\"x\", d => d.x0 + 5).attr(\"y\", (d, i) => d.y0 + 15 + i * 2) // offset by index \n    .text(d => d.text).attr(\"font-size\", \"0.5em\").attr(\"fill\", \"white\");\n    svg.selectAll('rect').on(\"mouseover\", function (d) {\n      {\n        console.log(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value);\n      }\n      tooltip.text(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value);\n      tooltip.style(\"visibility\", \"visible\");\n    }).on(\"mousemove\", function (event, d) {\n      return tooltip.style(\"top\", event.pageY - 10 + \"px\").style(\"left\", event.pageX + 10 + \"px\");\n    }).on(\"mouseout\", function () {\n      return tooltip.style(\"visibility\", \"hidden\");\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"svg\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 13\n      }\n    });\n  }\n\n}\n\nexport default TreeMap;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/TreeMap.js"],"names":["React","d3","range","TreeMap","Component","constructor","props","removeMap","bind","createMap","state","svg","width","height","componentDidMount","owidth","size","oheight","margin","top","right","bottom","left","select","attr","setState","componentDidUpdate","selectAll","remove","div","tooltip","style","text","rawdata","data","dataset","name","forEach","d","push","diagnosis","children","values","console","log","hierarchy","sum","value","sort","a","b","treemap","padding","categories","map","root","colors","colorScale","scaleOrdinal","domain","leaves","enter","append","x0","y0","x1","y1","parent","split","v","i","on","path","__data__","event","pageY","pageX","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport { range } from 'd3';\n\nclass TreeMap extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeMap = this.removeMap.bind(this);\n        this.createMap = this.createMap.bind(this)\n        this.state = {\n            svg: null,\n            width: null,\n            height: null,\n        };\n\n    }\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#tm\").select(\"svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n\n        this.setState({ svg });\n        this.setState({ width });\n        this.setState({ height });\n\n    }\n    componentDidUpdate() {\n        this.removeMap();\n        this.createMap();\n    }\n\n\n    removeMap() {\n        const { svg } = this.state;\n\n        svg.selectAll(\"*\").remove();\n\n    }\n\n    createMap() {\n        const { svg } = this.state;\n        const { width } = this.state;\n        const { height } = this.state;\n        const { div } = this.state;\n\n        var tooltip = div\n            .style(\"position\", \"absolute\")\n            .style(\"z-index\", \"10\")\n            .style(\"visibility\", \"hidden\")\n            .style(\"color\", \"white\")\n            .style(\"padding\", \"8px\")\n            .style(\"background-color\", \"rgba(0, 0, 0, 0.75)\")\n            .style(\"border-radius\", \"6px\")\n            .style(\"font\", \"12px sans-serif\")\n            .text(\"tooltip\");\n\n        const rawdata = this.props.data\n        let dataset = {\n            name: \"q8\",\n            \"children\": []\n        };\n\n        rawdata.forEach(function (d) {\n            dataset[\"children\"].push({\n                name: d.diagnosis,\n                children: d.values\n            })\n        })\n        let data = dataset\n        console.log(data)\n        const hierarchy = d3.hierarchy(data)\n            .sum(d => d.value)  //sum every child's values\n            .sort((a, b) => b.value - a.value) // and sort them in descending order \n        const treemap = d3.treemap()\n            .size([width, height]) // width: 400px, height:450px\n            .padding(1);      // set padding to 1\n\n        const categories = dataset.children.map(d => d.name);\n\n        const root = treemap(hierarchy);\n        const colors = ['#1C1832', '#9E999D', '#F2259C', '#347EB4',\n            '#08ACB6', '#91BB91', '#BCD32F', '#75EDB8',\n            \"#89EE4B\", '#AD4FE8', '#D5AB61', '#BC3B3A',\n            '#F6A1F9', '#87ABBB', '#412433', '#56B870',\n            '#FDAB41', '#64624F']\n\n        const colorScale = d3.scaleOrdinal() // the scale function\n            .domain(categories) // the data\n            .range(colors)    // the way the data should be shown\n\n        svg.selectAll(\"rect\")\n            .data(root.leaves())\n            .enter()\n            .append(\"rect\")\n            .attr(\"x\", d => d.x0)\n            .attr(\"y\", d => d.y0)\n            .attr(\"width\", d => d.x1 - d.x0)\n            .attr(\"height\", d => d.y1 - d.y0)\n            .attr(\"fill\", d => colorScale(d.data.value))\n            .attr(\"font-size\", \"15px\")\n\n\n        svg.selectAll('text')\n            .data(root.leaves())\n            .enter()\n            .append('text')\n            .selectAll('tspan')\n            .data(d => {\n                { console.log(d.parent.data.name)}\n                return (d.parent.data.name.split(/(?=[A-Z][^A-Z])/g))// split the name of movie\n                    .map(v => {\n                        { console.log(v) }\n                        return {\n                            text: v,\n                            x0: d.x0,                        // keep x0 reference\n                            y0: d.y0                         // keep y0 reference\n                        }\n                    });\n            })\n            .enter()\n            .append('tspan')\n            .attr(\"x\", (d) => d.x0 + 5)\n            .attr(\"y\", (d, i) => d.y0 + 15 + (i * 2))       // offset by index \n            .text((d) => d.text)\n            .attr(\"font-size\", \"0.5em\")\n            .attr(\"fill\", \"white\");\n        \n            svg.selectAll('rect')\n            .on(\"mouseover\", function (d) {\n                { console.log(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value)}\n                tooltip.text(d.path[0].__data__.parent.data.name + \": \" + d.path[0].__data__.data.value);\n                tooltip.style(\"visibility\", \"visible\");\n            })\n            .on(\"mousemove\", function (event, d) {\n                return tooltip.style(\"top\", (event.pageY - 10) + \"px\").style(\"left\", (event.pageX + 10) + \"px\");\n            })\n            .on(\"mouseout\", function () { return tooltip.style(\"visibility\", \"hidden\"); });\n\n\n    }\n\n\n    render() {\n        return (\n            <svg />\n        )\n    }\n\n}\n\nexport default TreeMap;\n"]},"metadata":{},"sourceType":"module"}