{"ast":null,"code":"var _jsxFileName = \"/Users/chia/Desktop/USF/senior team/dashboard/src/views/dashboard/DashboardView/d3/GroupedBarChart.js\";\nimport React from 'react';\nimport * as d3 from 'd3'; // import './GroupedBarChart.css'\n\nimport * as d3l from 'd3-svg-legend';\n\nclass GroupedBarChart extends React.Component {\n  constructor(props) {\n    super(props);\n    this.removeExistingBars = this.removeExistingBars.bind(this);\n    this.createBarChart = this.createBarChart.bind(this);\n    this.state = {\n      svg: null,\n      div: null,\n      width: null,\n      height: null,\n      margin: null\n    };\n  }\n\n  componentDidMount() {\n    const owidth = this.props.size[0];\n    const oheight = this.props.size[1];\n    var margin = {\n      top: 20,\n      right: 0,\n      bottom: 20,\n      left: 70\n    },\n        width = owidth - margin.left - margin.right,\n        height = oheight - margin.top - margin.bottom;\n    const svg = d3.select(\"body\").select(\"#gbc\").select(\"svg\").attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    var div = d3.select(\"body\").select(\"#gbc\").append(\"div\").style(\"position\", \"absolute\").style(\"z-index\", \"10\").style(\"visibility\", \"hidden\").style(\"color\", \"white\").style(\"padding\", \"8px\").style(\"background-color\", \"rgba(0, 0, 0, 0.75)\").style(\"border-radius\", \"6px\").style(\"font\", \"12px sans-serif\").text(\"tooltip\");\n    this.setState({\n      svg,\n      div,\n      width,\n      height,\n      margin\n    });\n  }\n\n  componentDidUpdate() {\n    this.removeExistingBars();\n    this.createBarChart();\n  }\n\n  midpoint(range) {\n    return range[0] + (range[1] - range[0]) / 2.0;\n  }\n\n  removeExistingBars() {\n    const {\n      svg\n    } = this.state;\n    svg.selectAll(\"*\").remove();\n  }\n\n  createBarChart() {\n    const {\n      svg\n    } = this.state;\n    var {\n      div\n    } = this.state;\n    const {\n      width\n    } = this.state;\n    const {\n      height\n    } = this.state;\n    const {\n      margin\n    } = this.state;\n    const data = this.props.data;\n    const scale = this.props.scale.logarithmic;\n    const label = this.props.selector;\n    console.log(\"data\", data);\n    var dnames = data.map(function (d) {\n      return d.diagnosis;\n    });\n    var gname = data[0].values.map(function (d) {\n      return d.distribution;\n    });\n    console.log(\"dname\", dnames);\n    console.log(\"gname\", gname);\n\n    function getKeyByValue(object, value) {\n      return Object.keys(object).find(key => object[key] === value);\n    }\n\n    var xScale = d3.scaleBand().range([0, width]) // output\n    .padding(0.1);\n    var yScale;\n\n    if (scale) {\n      console.log(\"logarithmic\");\n      console.log(scale);\n      yScale = d3.scaleLog().base(Math.E).domain([Math.exp(0), Math.exp(9)]).range([height, 0]);\n    } else {\n      console.log(\"logarithmic\");\n      console.log(scale);\n      yScale = d3.scaleLinear().range([height, 0]); // output\n\n      yScale.domain([0, d3.max(data, function (key) {\n        return d3.max(key.values, function (d) {\n          return d.value;\n        });\n      })]);\n    }\n\n    var color = d3.scaleOrdinal().domain(gname).range([\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\", \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\", \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\", \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"]);\n    console.log(\"graphdata\", data);\n    var xScale1 = d3.scaleBand();\n    xScale.domain(dnames);\n    xScale1.domain(gname).rangeRound([0, xScale.bandwidth()]);\n    svg.append(\"g\").attr(\"class\", \"x axis\").attr(\"transform\", \"translate(0,\" + height + \")\").call(d3.axisBottom(xScale));\n    svg.append(\"g\").attr(\"class\", \"y axis\").call(d3.axisLeft(yScale).tickFormat(d3.formatPrefix(\".0\", 1e1)));\n    var legend = d3l.legendColor().scale(color).shape('circle').orient('vertical').labelOffset(5);\n    svg.append(\"g\").attr(\"class\", \"legend\").attr(\"transform\", \"translate(\" + (width - 100) + \", \" + 20 + \")\");\n    svg.select(\".legend\").call(legend);\n    var slice = svg.selectAll(\".slice\").data(data).enter().append(\"g\").attr(\"class\", \"g\").attr(\"transform\", function (d) {\n      return \"translate(\" + xScale(d.diagnosis) + \",0)\";\n    });\n    var colors = [\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\", \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\", \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\", \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"];\n    slice.selectAll(\"rect\").data(function (d) {\n      return d.values;\n    }).enter().append(\"rect\").attr(\"width\", xScale1.bandwidth()).attr(\"x\", function (d) {\n      {\n        console.log(\"x\", d.distribution);\n      }\n      return xScale1(d.distribution);\n    }).attr(\"y\", function (d) {\n      {\n        console.log(d.value);\n      }\n      return yScale(d.value);\n    }).style(\"fill\", function (d, i) {\n      return colors[i];\n    }).attr(\"height\", function (d) {\n      return height - yScale(d.value);\n    }).on(\"mouseover\", function (d) {\n      console.log(d.path[0].__data__);\n      div.text(\"Gender: \" + d.path[0].__data__.distribution + \": \" + \"Amount: \" + d.path[0].__data__.value);\n      div.style(\"visibility\", \"visible\");\n    }).on(\"mousemove\", function (event, d) {\n      return div.style(\"top\", event.pageY - 10 + \"px\").style(\"left\", event.pageX + 10 + \"px\");\n    }).on(\"mouseout\", function () {\n      return div.style(\"visibility\", \"hidden\");\n    });\n    let size = 1;\n    svg.selectAll(\"g\").data(data).enter().append(\"text\").attr(\"x\", 10).attr(\"y\", function (d, i) {\n      return 10;\n    }) // 100 is where the first dot appears. 25 is the distance between dots\n    .style(\"fill\", function (d) {\n      return color(d.distribution);\n    }).text(function (d) {\n      return d.distribution;\n    }).attr(\"text-anchor\", \"left\");\n    const xmid = xScale.range()[0] + (xScale.range()[1] - xScale.range()[0]) / 2.0;\n    const ymid = yScale.range()[0] + (yScale.range()[1] - yScale.range()[0]) / 2.0;\n    const xtitle = svg.append('text').attr('class', 'axis-title').text('Diseases');\n    xtitle.attr('text-anchor', 'middle');\n    xtitle.attr('x', xmid);\n    xtitle.attr('y', height + 40);\n    const ytitle = svg.append('text').attr('class', 'axis-title').text('Number of Patients');\n    ytitle.attr('x', xmid);\n    ytitle.attr('y', height + 40);\n    ytitle.attr('dy', '1.75ex');\n    ytitle.attr('text-anchor', 'middle');\n    ytitle.attr('transform', 'rotate(-90)');\n    const tooltip = d3.select('#container').append('div').attr('class', 'tooltip').style('opacity', 0);\n\n    function mouseover() {\n      d3.select(this).attr(\"opacity\", .5);\n    }\n\n    function mouseout() {\n      d3.select(this).attr(\"opacity\", 1);\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"svg\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 13\n      }\n    });\n  }\n\n}\n\nexport default GroupedBarChart;","map":{"version":3,"sources":["/Users/chia/Desktop/USF/senior team/dashboard/src/views/dashboard/DashboardView/d3/GroupedBarChart.js"],"names":["React","d3","d3l","GroupedBarChart","Component","constructor","props","removeExistingBars","bind","createBarChart","state","svg","div","width","height","margin","componentDidMount","owidth","size","oheight","top","right","bottom","left","select","attr","append","style","text","setState","componentDidUpdate","midpoint","range","selectAll","remove","data","scale","logarithmic","label","selector","console","log","dnames","map","d","diagnosis","gname","values","distribution","getKeyByValue","object","value","Object","keys","find","key","xScale","scaleBand","padding","yScale","scaleLog","base","Math","E","domain","exp","scaleLinear","max","color","scaleOrdinal","xScale1","rangeRound","bandwidth","call","axisBottom","axisLeft","tickFormat","formatPrefix","legend","legendColor","shape","orient","labelOffset","slice","enter","colors","i","on","path","__data__","event","pageY","pageX","xmid","ymid","xtitle","ytitle","tooltip","mouseover","mouseout","render"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\n// import './GroupedBarChart.css'\nimport * as d3l from 'd3-svg-legend'\n\nclass GroupedBarChart extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeExistingBars = this.removeExistingBars.bind(this);\n        this.createBarChart = this.createBarChart.bind(this)\n        this.state = {\n            svg: null,\n            div: null,\n            width: null,\n            height: null,\n            margin: null\n        };\n    }\n\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 0, bottom: 20, left: 70 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#gbc\").select(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        var div = d3.select(\"body\").select(\"#gbc\").append(\"div\")\n        .style(\"position\", \"absolute\")\n        .style(\"z-index\", \"10\")\n        .style(\"visibility\", \"hidden\")\n        .style(\"color\", \"white\")\n        .style(\"padding\", \"8px\")\n        .style(\"background-color\", \"rgba(0, 0, 0, 0.75)\")\n        .style(\"border-radius\", \"6px\")\n        .style(\"font\", \"12px sans-serif\")\n        .text(\"tooltip\");\n        this.setState({ svg, div, width, height, margin });\n    }\n\n    componentDidUpdate() {\n        this.removeExistingBars();\n        this.createBarChart();\n    }\n\n    midpoint(range) {\n        return range[0] + (range[1] - range[0]) / 2.0;\n    }\n\n    removeExistingBars() {\n        const { svg } = this.state;\n        svg.selectAll(\"*\").remove();\n    }\n\n    createBarChart() {\n        const { svg } = this.state;\n        var { div } = this.state;\n        const { width } = this.state;\n        const { height } = this.state;\n        const { margin } = this.state;\n\n\n        const data = this.props.data\n        const scale = this.props.scale.logarithmic\n        const label = this.props.selector\n\n        console.log(\"data\", data);\n        var dnames = data.map(function (d) { return d.diagnosis; });\n        var gname = data[0].values.map(function (d) { return d.distribution; });\n\n        console.log(\"dname\", dnames)\n        console.log(\"gname\", gname)\n\n\n        function getKeyByValue(object, value) {\n            return Object.keys(object).find(key => object[key] === value);\n        }\n\n        var xScale = d3.scaleBand()\n            .range([0, width]) // output\n            .padding(0.1)\n\n        var yScale;\n        if (scale) {\n            console.log(\"logarithmic\")\n            console.log(scale)\n            yScale = d3.scaleLog()\n                .base(Math.E)\n                .domain([Math.exp(0), Math.exp(9)])\n                .range([height, 0]);        }\n        else {\n            console.log(\"logarithmic\")\n            console.log(scale)\n            yScale = d3.scaleLinear()\n                .range([height, 0]); // output\n            yScale.domain([0, d3.max(data, function (key) { return d3.max(key.values, function (d) { return d.value; }); })]);\n        }\n\n\n        var color = d3.scaleOrdinal()\n        .domain(gname)\n        .range([\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\",\n                \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\",\n                \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\",\n                \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"]);\n\n        console.log(\"graphdata\", data)\n\n        var xScale1 = d3.scaleBand()\n\n        xScale.domain(dnames);\n        xScale1.domain(gname).rangeRound([0, xScale.bandwidth()]);\n\n        svg.append(\"g\")\n            .attr(\"class\", \"x axis\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(d3.axisBottom(xScale));\n\n        svg.append(\"g\")\n            .attr(\"class\", \"y axis\")\n            .call(d3.axisLeft(yScale).tickFormat(d3.formatPrefix(\".0\",1e1)));\n\n        var legend = d3l.legendColor()\n            .scale(color)\n            .shape('circle')\n            .orient('vertical')\n            .labelOffset(5)\n\n        svg.append(\"g\")\n            .attr(\"class\", \"legend\")\n            .attr(\"transform\", \"translate(\" + (width-100) + \", \" + 20+\")\");\n\n        svg.select(\".legend\")\n            .call(legend);\n\n        var slice = svg.selectAll(\".slice\")\n            .data(data)\n            .enter().append(\"g\")\n            .attr(\"class\", \"g\")\n            .attr(\"transform\", function (d) { return \"translate(\" + xScale(d.diagnosis) + \",0)\"; });\n\n        var colors = [\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\",\n                      \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\",\n                      \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\",\n                      \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"];\n\n        slice.selectAll(\"rect\")\n            .data(function (d) { return d.values; })\n            .enter().append(\"rect\")\n            .attr(\"width\", xScale1.bandwidth())\n            .attr(\"x\", function (d) { { console.log(\"x\", d.distribution) } return xScale1(d.distribution); })\n            .attr(\"y\", function (d) { { console.log(d.value) } return yScale(d.value); })\n            .style(\"fill\", function (d,i) { return colors[i]; })\n            .attr(\"height\", function (d) { return height - yScale(d.value); })\n            .on(\"mouseover\", function (d) {\n                console.log(d.path[0].__data__)\n                div.text(\"Gender: \"+ d.path[0].__data__.distribution + \": \" + \"Amount: \"+ d.path[0].__data__.value);\n                div.style(\"visibility\", \"visible\");\n            })\n            .on(\"mousemove\", function (event, d) {\n                return div.style(\"top\", (event.pageY - 10) + \"px\").style(\"left\", (event.pageX + 10) + \"px\");\n            })\n            .on(\"mouseout\", function () { return div.style(\"visibility\", \"hidden\"); });\n\n        let size = 1\n        svg.selectAll(\"g\")\n            .data(data)\n            .enter()\n            .append(\"text\")\n            .attr(\"x\", 10)\n            .attr(\"y\", function (d, i) { return 10 }) // 100 is where the first dot appears. 25 is the distance between dots\n            .style(\"fill\", function (d) { return color(d.distribution) })\n            .text(function (d) { return d.distribution })\n            .attr(\"text-anchor\", \"left\")\n\n\n        const xmid = xScale.range()[0] + (xScale.range()[1] - xScale.range()[0]) / 2.0;\n        const ymid = yScale.range()[0] + (yScale.range()[1] - yScale.range()[0]) / 2.0;\n        const xtitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('Diseases');\n        xtitle.attr('text-anchor', 'middle');\n        xtitle.attr('x', xmid);\n        xtitle.attr('y', height + 40);\n        const ytitle = svg.append('text')\n            .attr('class', 'axis-title')\n            .text('Number of Patients')\n        ytitle.attr('x', xmid);\n        ytitle.attr('y', height + 40);\n        ytitle.attr('dy', '1.75ex');\n        ytitle.attr('text-anchor', 'middle');\n        ytitle.attr('transform', 'rotate(-90)');\n\n        const tooltip = d3\n            .select('#container')\n            .append('div')\n            .attr('class', 'tooltip')\n            .style('opacity', 0);\n\n        function mouseover() {\n            d3.select(this).attr(\"opacity\", .5)\n        }\n\n        function mouseout() {\n            d3.select(this).attr(\"opacity\", 1);\n        }\n    }\n\n    render() {\n        return (\n            <svg/>\n        )\n    }\n}\n\nexport default GroupedBarChart;\n"]},"metadata":{},"sourceType":"module"}