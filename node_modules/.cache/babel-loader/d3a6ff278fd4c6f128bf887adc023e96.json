{"ast":null,"code":"import _classCallCheck from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/aditya/Dropbox/Senior S1/ST/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import*as d3 from'd3';import*as d3l from'd3-svg-legend';var WaffleChart=/*#__PURE__*/function(_React$Component){_inherits(WaffleChart,_React$Component);var _super=_createSuper(WaffleChart);function WaffleChart(props){var _this;_classCallCheck(this,WaffleChart);_this=_super.call(this,props);_this.removeExistingBars=_this.removeExistingBars.bind(_assertThisInitialized(_this));_this.createBarChart=_this.createBarChart.bind(_assertThisInitialized(_this));_this.state={svg:null,width:0,height:0};return _this;}_createClass(WaffleChart,[{key:\"componentDidMount\",value:function componentDidMount(){var width=this.props.size[0];var height=this.props.size[1];// var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n//     width = owidth - margin.left - margin.right,\n//     height = oheight - margin.top - margin.bottom;\nvar svg=d3.select(\"body\").select(\"#wc\").select(\"svg\").attr(\"width\",width).attr(\"height\",height).append(\"g\");// .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\nthis.setState({svg:svg,width:width,height:height});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.removeExistingBars();this.createBarChart();}},{key:\"midpoint\",value:function midpoint(range){return range[0]+(range[1]-range[0])/2.0;}},{key:\"removeExistingBars\",value:function removeExistingBars(){var svg=this.state.svg;svg.selectAll(\"*\").remove();}},{key:\"createBarChart\",value:function createBarChart(){var svg=this.state.svg;var width=this.state.width;var height=this.state.height;var data=this.props.data;console.log(\"the incoming data\",data);var total=0;var widthSquares=20,heightSquares=5,squareSize=25,squareValue=0,gap=1,theData=[];var color=d3.scaleOrdinal(d3.schemeCategory10);//total\ntotal=d3.sum(data,function(d){return d.total;});//value of a square\nsquareValue=total/(widthSquares*heightSquares);//remap data\ndata.forEach(function(d,i){console.log(\"dataeach\",d);console.log(\"index\",i);d.total=+d.total;d.units=Math.floor(d.total/squareValue)<1?1:Math.floor(d.total/squareValue);theData=theData.concat(Array(d.units+1).join(1).split('').map(function(){return{squareValue:squareValue,units:d.units,total:d.total,groupIndex:i};}));});width=squareSize*widthSquares+widthSquares*gap+25;height=squareSize*heightSquares+heightSquares*gap+25;console.log(\"end\");console.log(theData);svg.append(\"g\").attr(\"width\",width).attr(\"height\",height).append(\"g\").selectAll(\"div\").data(theData).enter().append(\"rect\").attr(\"width\",squareSize).attr(\"height\",squareSize).attr(\"fill\",function(d){{console.log(d);}return color(data[d.groupIndex].diagnosis);}).attr(\"x\",function(d,i){//group n squares for column\nvar col=Math.floor(i/heightSquares);return col*squareSize+col*gap;}).attr(\"y\",function(d,i){var row=i%heightSquares;return heightSquares*squareSize-(row*squareSize+row*gap);}).append(\"title\").text(function(d,i){return\"diagnosis range: \"+data[d.groupIndex].diagnosis+\" | \"+d.total+\" , \"+d.units+\"%\";});var legend=d3l.legendColor().scale(color).shape('circle').orient('vertical').labelOffset(5);svg.append(\"g\").attr(\"class\",\"legend\").attr(\"transform\",\"translate(\"+(width-10)+\", \"+10+\")\").style(\"font-size\",\"12\");svg.select(\".legend\").call(legend);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"svg\",null);}}]);return WaffleChart;}(React.Component);export default WaffleChart;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Senior S1/ST/dashboard/src/views/dashboard/DashboardView/WaffleChart.js"],"names":["React","d3","d3l","WaffleChart","props","removeExistingBars","bind","createBarChart","state","svg","width","height","size","select","attr","append","setState","range","selectAll","remove","data","console","log","total","widthSquares","heightSquares","squareSize","squareValue","gap","theData","color","scaleOrdinal","schemeCategory10","sum","d","forEach","i","units","Math","floor","concat","Array","join","split","map","groupIndex","enter","diagnosis","col","row","text","legend","legendColor","scale","shape","orient","labelOffset","style","call","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport * as d3l from 'd3-svg-legend'\n\nclass WaffleChart extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeExistingBars = this.removeExistingBars.bind(this);\n        this.createBarChart = this.createBarChart.bind(this)\n        this.state = {\n            svg: null,\n            width: 0,\n            height: 0\n        };\n\n    }\n    componentDidMount() {\n        const width = this.props.size[0]\n        const height = this.props.size[1]\n\n        // var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n        //     width = owidth - margin.left - margin.right,\n        //     height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#wc\").select(\"svg\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .append(\"g\")\n            // .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n\n        this.setState({ svg, width, height });\n    }\n    componentDidUpdate() {\n        this.removeExistingBars();\n        this.createBarChart();\n    }\n\n    midpoint(range) {\n        return range[0] + (range[1] - range[0]) / 2.0;\n    }\n\n    removeExistingBars() {\n        const { svg } = this.state;\n\n        svg.selectAll(\"*\").remove();\n\n    }\n\n    createBarChart() {\n        const { svg } = this.state;\n        let { width } = this.state;\n        let { height } = this.state;\n\n        const data = this.props.data\n        console.log(\"the incoming data\", data)\n        var total = 0;\n        var\n            widthSquares = 20,\n            heightSquares = 5,\n            squareSize = 25,\n            squareValue = 0,\n            gap = 1,\n            theData = [];\n\n        var color = d3.scaleOrdinal(d3.schemeCategory10);\n\n        //total\n        total = d3.sum(data, function (d) { return d.total; });\n\n        //value of a square\n        squareValue = total / (widthSquares * heightSquares);\n\n        //remap data\n        data.forEach(function (d, i) {\n\n            console.log(\"dataeach\", d)\n            console.log(\"index\", i)\n            d.total = +d.total;\n            d.units = (Math.floor(d.total / squareValue)) < 1 ? 1 : (Math.floor(d.total / squareValue));\n            theData = theData.concat(\n                Array(d.units + 1).join(1).split('').map(function () {\n                    return {\n\n                        squareValue: squareValue,\n                        units: d.units,\n                        total: d.total,\n                        groupIndex: i\n\n                    };\n                })\n            );\n        });\n\n        width = (squareSize * widthSquares) + widthSquares * gap + 25;\n        height = (squareSize * heightSquares) + heightSquares * gap + 25;\n        console.log(\"end\")\n        console.log(theData)\n        svg.append(\"g\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .append(\"g\")\n            .selectAll(\"div\")\n            .data(theData)\n            .enter()\n            .append(\"rect\")\n            .attr(\"width\", squareSize)\n            .attr(\"height\", squareSize)\n            .attr(\"fill\", function (d) {\n                { console.log(d) }\n                return color(data[d.groupIndex].diagnosis);\n            })\n            .attr(\"x\", function (d, i) {\n                //group n squares for column\n                let col = Math.floor(i / heightSquares);\n                return (col * squareSize) + (col * gap);\n            })\n            .attr(\"y\", function (d, i) {\n                let row = i % heightSquares;\n                return (heightSquares * squareSize) - ((row * squareSize) + (row * gap))\n            })\n            .append(\"title\")\n            .text(function (d, i) {\n                return \"diagnosis range: \" + data[d.groupIndex].diagnosis + \" | \" + d.total + \" , \" + d.units + \"%\"\n            });\n\n        var legend = d3l.legendColor()\n            .scale(color)\n            .shape('circle')\n            .orient('vertical')\n            .labelOffset(5)\n\n\n        svg.append(\"g\")\n            .attr(\"class\", \"legend\")\n            .attr(\"transform\", \"translate(\" + (width - 10) + \", \" + 10 + \")\")\n            .style(\"font-size\", \"12\")\n\n        svg.select(\".legend\")\n            .call(legend);\n        \n    }\n\n\n\n    render() {\n        return (\n            <svg />\n        )\n    }\n\n}\n\nexport default WaffleChart;\n"]},"metadata":{},"sourceType":"module"}