{"ast":null,"code":"import _classCallCheck from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/aditya/Dropbox/Wesbite/dashboard/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import*as d3 from'd3';import*as d3l from'd3-svg-legend';import{event as currentEvent}from'd3-selection';var svg_count=0;var AreaChart=/*#__PURE__*/function(_React$Component){_inherits(AreaChart,_React$Component);var _super=_createSuper(AreaChart);function AreaChart(props){var _this;_classCallCheck(this,AreaChart);_this=_super.call(this,props);_this.removeExistingBars=_this.removeExistingBars.bind(_assertThisInitialized(_this));_this.createBarChart=_this.createBarChart.bind(_assertThisInitialized(_this));_this.state={svg:null,legend:null,width:0,height:0};return _this;}_createClass(AreaChart,[{key:\"componentDidMount\",value:function componentDidMount(){var owidth=this.props.size[0];var oheight=this.props.size[1];var margin={top:20,right:20,bottom:70,left:100},width=owidth-margin.left-margin.right,height=oheight-margin.top-margin.bottom;var svg=d3.select(\"body\").select(\"#ac\").select(\"svg\").attr(\"width\",width+margin.left+margin.right).attr(\"height\",height+margin.top+margin.bottom).append(\"g\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");var legend=d3.select(\"body\").select(\"#ac\").append(\"svg\").attr(\"width\",300+margin.left+margin.right).attr(\"height\",250+margin.top+margin.bottom).append(\"g\").attr(\"transform\",\"translate(\"+margin.left+\",\"+margin.top+\")\");this.setState({svg:svg,legend:legend,width:width,height:height});}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.removeExistingBars();this.createBarChart();}},{key:\"midpoint\",value:function midpoint(range){return range[0]+(range[1]-range[0])/2.0;}},{key:\"removeExistingBars\",value:function removeExistingBars(){var svg=this.state.svg;svg.selectAll(\"*\").remove();}},{key:\"createBarChart\",value:function createBarChart(){var svg=this.state.svg;var width=this.state.width;var height=this.state.height;var legend=this.state.legend;var output=this.props.data;var data=output.filter(function(e){return e.id<299;});var color=d3.scaleOrdinal().range([\"#60a3bc\",\"#e55039\",\"#4a69bd\",\"#f6b93b\",\"#78e08f\",\"#0a3d62\",\"#b71540\",\"#0c2461\",\"#e58e26\",\"#079992\",\"#3c6382\",\"#eb2f06\",\"#1e3799\",\"#fa983a\",\"#38ada9\",\"#82ccdd\",\"#f8c291\",\"#6a89cc\",\"#fad390\",\"#b8e994\"]);var keys=this.props.keys;console.log(keys);var stackedData=d3.stack().keys(keys)(data);console.log(\"originalData\",data);console.log(\"pancake\",stackedData);// color palette\nvar color=d3.scaleOrdinal().domain(keys).range([\"#60a3bc\",\"#e55039\",\"#4a69bd\",\"#f6b93b\",\"#78e08f\",\"#0a3d62\",\"#b71540\",\"#0c2461\",\"#e58e26\",\"#079992\",\"#3c6382\",\"#eb2f06\",\"#1e3799\",\"#fa983a\",\"#38ada9\",\"#82ccdd\",\"#f8c291\",\"#6a89cc\",\"#fad390\",\"#b8e994\"]);//////////\n// AXIS //\n//////////\n// Add X axis\nvar x=d3.scaleLinear().domain(d3.extent(data,function(d){return d.id;})).range([0,width]);var xAxis=svg.append(\"g\").attr(\"transform\",\"translate(0,\"+height+\")\").call(d3.axisBottom(x).ticks(5));// Add X axis label:\nsvg.append(\"text\").attr(\"text-anchor\",\"end\").attr(\"x\",width).attr(\"y\",height+40).text(\"Age\");// Add Y axis label:\nsvg.append(\"text\").attr(\"text-anchor\",\"end\").attr(\"x\",0).attr(\"y\",-20).text(\"Distribution\").attr(\"text-anchor\",\"start\");// Add Y axis\nvar y=d3.scaleLinear().domain([0,500]).range([height,0]);svg.append(\"g\").call(d3.axisLeft(y).ticks(5));//////////\n// BRUSHING AND CHART //\n//////////\n// Add a clipPath: everything out of this area won't be drawn.\nvar clip=svg.append(\"defs\").append(\"svg:clipPath\").attr(\"id\",\"clip\").append(\"svg:rect\").attr(\"width\",width).attr(\"height\",height).attr(\"x\",0).attr(\"y\",0);// Add brushing\nvar brush=d3.brushX()// Add the brush feature using the d3.brush function\n.extent([[0,0],[width,height]])// initialise the brush area: start at 0,0 and finishes at width,height: it means I select the whole graph area\n.on(\"end\",updateChart);// Each time the brush selection changes, trigger the 'updateChart' function\n// Create the scatter variable: where both the circles and the brush take place\nvar areaChart=svg.append('g').attr(\"clip-path\",\"url(#clip)\");// Area generator\nvar area=d3.area().x(function(d){return x(d.data.id);}).y0(function(d){return y(d[0]);}).y1(function(d){return y(d[1]);});var colors=[\"#60a3bc\",\"#e55039\",\"#4a69bd\",\"#f6b93b\",\"#78e08f\",\"#0a3d62\",\"#b71540\",\"#0c2461\",\"#e58e26\",\"#079992\",\"#3c6382\",\"#eb2f06\",\"#1e3799\",\"#fa983a\",\"#38ada9\",\"#82ccdd\",\"#f8c291\",\"#6a89cc\",\"#fad390\",\"#b8e994\"];// Show the areas\nareaChart.selectAll(\"mylayers\").data(stackedData).enter().append(\"path\").attr(\"class\",function(d){return\"myArea \"+d.key;}).style(\"fill\",function(d,i){return colors[i];}).attr(\"d\",area);// Add the brushing\nareaChart.append(\"g\").attr(\"class\",\"brush\").call(brush);var idleTimeout;function idled(){idleTimeout=null;}// A function that update the chart for given boundaries\nfunction updateChart(event,d){var extent=event.selection;// If no selection, back to initial coordinate. Otherwise, update X axis domain\nif(!extent){if(!idleTimeout)return idleTimeout=setTimeout(idled,350);// This allows to wait a little bit\nx.domain(d3.extent(data,function(d){return d.id;}));}else{x.domain([x.invert(extent[0]),x.invert(extent[1])]);areaChart.select(\".brush\").call(brush.move,null);// This remove the grey brush area as soon as the selection has been done\n}// Update axis and area position\nxAxis.transition().duration(1000).call(d3.axisBottom(x).ticks(5));areaChart.selectAll(\"path\").transition().duration(1000).attr(\"d\",area);}//////////\n// HIGHLIGHT GROUP //\n//////////\n// What to do when one group is hovered\nvar highlight=function highlight(d){console.log(d);// reduce opacity of all groups\nd3.selectAll(\".myArea\").style(\"opacity\",.1);// expect the one that is hovered\nd3.select(\".\"+d).style(\"opacity\",1);};// And when it is not hovered anymore\nvar noHighlight=function noHighlight(d){d3.selectAll(\".myArea\").style(\"opacity\",1);};var legendf=d3l.legendColor().scale(color).shape('circle').orient('vertical').labelOffset(5);legend.append(\"g\").attr(\"class\",\"legend\")// .attr(\"transform\", \"translate(\" + (width - 80) + \", \" + 20 + \")\")\n.style(\"font-size\",\"12\");legend.select(\".legend\").call(legendf);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"svg\",null);}}]);return AreaChart;}(React.Component);export default AreaChart;","map":{"version":3,"sources":["/Users/aditya/Dropbox/Wesbite/dashboard/src/views/dashboard/DashboardView/d3/AreaChart.js"],"names":["React","d3","d3l","event","currentEvent","svg_count","AreaChart","props","removeExistingBars","bind","createBarChart","state","svg","legend","width","height","owidth","size","oheight","margin","top","right","bottom","left","select","attr","append","setState","range","selectAll","remove","output","data","filter","e","id","color","scaleOrdinal","keys","console","log","stackedData","stack","domain","x","scaleLinear","extent","d","xAxis","call","axisBottom","ticks","text","y","axisLeft","clip","brush","brushX","on","updateChart","areaChart","area","y0","y1","colors","enter","key","style","i","idleTimeout","idled","selection","setTimeout","invert","move","transition","duration","highlight","noHighlight","legendf","legendColor","scale","shape","orient","labelOffset","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport * as d3 from 'd3';\nimport * as d3l from 'd3-svg-legend'\nimport { event as currentEvent } from 'd3-selection';\n\nlet svg_count = 0;\n\nclass AreaChart extends React.Component {\n    constructor(props) {\n        super(props)\n        this.removeExistingBars = this.removeExistingBars.bind(this);\n        this.createBarChart = this.createBarChart.bind(this)\n        this.state = {\n            svg: null,\n            legend:null,\n            width: 0,\n            height: 0\n        };\n\n    }\n\n    componentDidMount() {\n        const owidth = this.props.size[0]\n        const oheight = this.props.size[1]\n\n        var margin = { top: 20, right: 20, bottom: 70, left: 100 },\n            width = owidth - margin.left - margin.right,\n            height = oheight - margin.top - margin.bottom;\n\n        const svg = d3.select(\"body\").select(\"#ac\").select(\"svg\")\n            .attr(\"width\", width + margin.left + margin.right)\n            .attr(\"height\", height + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        const legend = d3.select(\"body\").select(\"#ac\").append(\"svg\")\n            .attr(\"width\", 300 + margin.left + margin.right)\n            .attr(\"height\", 250 + margin.top + margin.bottom)\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        this.setState({ svg, legend, width, height });\n    }\n\n    componentDidUpdate() {\n        this.removeExistingBars();\n        this.createBarChart();\n    }\n\n    midpoint(range) {\n        return range[0] + (range[1] - range[0]) / 2.0;\n    }\n\n    removeExistingBars() {\n        const { svg } = this.state;\n        svg.selectAll(\"*\").remove();\n    }\n\n    createBarChart() {\n        const { svg } = this.state;\n        const { width } = this.state;\n        const { height } = this.state;\n        const { legend } = this.state;\n\n        const output = this.props.data\n\n        let data = output.filter(function (e) {\n            return e.id < 299;\n        });\n\n        var color = d3.scaleOrdinal().range([\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\",\n                \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\",\n                \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\",\n                \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"]);\n\n        var keys = this.props.keys\n        console.log(keys)\n        var stackedData = d3.stack()\n            .keys(keys)\n            (data)\n\n        console.log(\"originalData\", data)\n        console.log(\"pancake\", stackedData)\n\n        // color palette\n        var color = d3.scaleOrdinal()\n            .domain(keys)\n            .range([\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\",\n                    \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\",\n                    \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\",\n                    \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"]);\n\n        //////////\n        // AXIS //\n        //////////\n\n        // Add X axis\n        var x = d3.scaleLinear()\n            .domain(d3.extent(data, function (d) { return d.id; }))\n            .range([0, width]);\n\n        var xAxis = svg.append(\"g\")\n            .attr(\"transform\", \"translate(0,\" + height + \")\")\n            .call(d3.axisBottom(x).ticks(5))\n\n        // Add X axis label:\n        svg.append(\"text\")\n            .attr(\"text-anchor\", \"end\")\n            .attr(\"x\", width)\n            .attr(\"y\", height + 40)\n            .text(\"Age\");\n\n        // Add Y axis label:\n        svg.append(\"text\")\n            .attr(\"text-anchor\", \"end\")\n            .attr(\"x\", 0)\n            .attr(\"y\", -20)\n            .text(\"Distribution\")\n            .attr(\"text-anchor\", \"start\")\n\n        // Add Y axis\n        var y = d3.scaleLinear()\n            .domain([0, 500])\n            .range([height, 0]);\n        svg.append(\"g\")\n            .call(d3.axisLeft(y).ticks(5))\n\n        //////////\n        // BRUSHING AND CHART //\n        //////////\n\n        // Add a clipPath: everything out of this area won't be drawn.\n        var clip = svg.append(\"defs\").append(\"svg:clipPath\")\n            .attr(\"id\", \"clip\")\n            .append(\"svg:rect\")\n            .attr(\"width\", width)\n            .attr(\"height\", height)\n            .attr(\"x\", 0)\n            .attr(\"y\", 0);\n\n        // Add brushing\n        var brush = d3.brushX()                 // Add the brush feature using the d3.brush function\n            .extent([[0, 0], [width, height]]) // initialise the brush area: start at 0,0 and finishes at width,height: it means I select the whole graph area\n            .on(\"end\", updateChart) // Each time the brush selection changes, trigger the 'updateChart' function\n\n        // Create the scatter variable: where both the circles and the brush take place\n        var areaChart = svg.append('g')\n            .attr(\"clip-path\", \"url(#clip)\")\n\n        // Area generator\n        var area = d3.area()\n            .x(function (d) { return x(d.data.id); })\n            .y0(function (d) { return y(d[0]); })\n            .y1(function (d) { return y(d[1]); })\n\n        var colors = [\"#60a3bc\", \"#e55039\", \"#4a69bd\", \"#f6b93b\", \"#78e08f\",\n                      \"#0a3d62\", \"#b71540\", \"#0c2461\", \"#e58e26\", \"#079992\",\n                      \"#3c6382\", \"#eb2f06\", \"#1e3799\", \"#fa983a\", \"#38ada9\",\n                      \"#82ccdd\", \"#f8c291\", \"#6a89cc\", \"#fad390\", \"#b8e994\"];\n        // Show the areas\n        areaChart\n            .selectAll(\"mylayers\")\n            .data(stackedData)\n            .enter()\n            .append(\"path\")\n            .attr(\"class\", function (d) { return \"myArea \" + d.key })\n            .style(\"fill\", function (d, i) { return colors[i]; })\n            .attr(\"d\", area)\n\n        // Add the brushing\n        areaChart\n            .append(\"g\")\n            .attr(\"class\", \"brush\")\n            .call(brush);\n\n        var idleTimeout\n        function idled() { idleTimeout = null; }\n\n        // A function that update the chart for given boundaries\n        function updateChart(event, d) {\n\n            let extent = event.selection\n\n            // If no selection, back to initial coordinate. Otherwise, update X axis domain\n            if (!extent) {\n                if (!idleTimeout) return idleTimeout = setTimeout(idled, 350); // This allows to wait a little bit\n                x.domain(d3.extent(data, function (d) { return d.id; }))\n            } else {\n                x.domain([x.invert(extent[0]), x.invert(extent[1])])\n                areaChart.select(\".brush\").call(brush.move, null) // This remove the grey brush area as soon as the selection has been done\n            }\n\n            // Update axis and area position\n            xAxis.transition().duration(1000).call(d3.axisBottom(x).ticks(5))\n            areaChart\n                .selectAll(\"path\")\n                .transition().duration(1000)\n                .attr(\"d\", area)\n        }\n\n        //////////\n        // HIGHLIGHT GROUP //\n        //////////\n\n        // What to do when one group is hovered\n        var highlight = function (d) {\n            console.log(d)\n            // reduce opacity of all groups\n            d3.selectAll(\".myArea\").style(\"opacity\", .1)\n            // expect the one that is hovered\n            d3.select(\".\" + d).style(\"opacity\", 1)\n        }\n\n        // And when it is not hovered anymore\n        var noHighlight = function (d) {\n            d3.selectAll(\".myArea\").style(\"opacity\", 1)\n        }\n\n        var legendf = d3l.legendColor()\n            .scale(color)\n            .shape('circle')\n            .orient('vertical')\n            .labelOffset(5)\n\n        legend.append(\"g\")\n            .attr(\"class\", \"legend\")\n            // .attr(\"transform\", \"translate(\" + (width - 80) + \", \" + 20 + \")\")\n            .style(\"font-size\", \"12\")\n\n        legend.select(\".legend\")\n            .call(legendf);\n    }\n\n    render() {\n        return (\n            <svg />\n        )\n    }\n}\n\nexport default AreaChart;\n"]},"metadata":{},"sourceType":"module"}